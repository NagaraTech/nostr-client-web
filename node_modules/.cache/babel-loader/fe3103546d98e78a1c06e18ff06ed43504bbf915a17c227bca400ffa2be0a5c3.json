{"ast":null,"code":"import _defineProperty from \"/Users/lance/myProject/nostr-client-web/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nvar __defProp = Object.defineProperty;\nvar __export = (target, all) => {\n  for (var name in all) __defProp(target, name, {\n    get: all[name],\n    enumerable: true\n  });\n};\n\n// pure.ts\nimport { schnorr } from \"@noble/curves/secp256k1\";\nimport { bytesToHex } from \"@noble/hashes/utils\";\n\n// core.ts\nvar verifiedSymbol = Symbol(\"verified\");\nvar isRecord = obj => obj instanceof Object;\nfunction validateEvent(event) {\n  if (!isRecord(event)) return false;\n  if (typeof event.kind !== \"number\") return false;\n  if (typeof event.content !== \"string\") return false;\n  if (typeof event.created_at !== \"number\") return false;\n  if (typeof event.pubkey !== \"string\") return false;\n  if (!event.pubkey.match(/^[a-f0-9]{64}$/)) return false;\n  if (!Array.isArray(event.tags)) return false;\n  for (let i2 = 0; i2 < event.tags.length; i2++) {\n    let tag = event.tags[i2];\n    if (!Array.isArray(tag)) return false;\n    for (let j = 0; j < tag.length; j++) {\n      if (typeof tag[j] === \"object\") return false;\n    }\n  }\n  return true;\n}\n\n// pure.ts\nimport { sha256 } from \"@noble/hashes/sha256\";\n\n// utils.ts\nvar utils_exports = {};\n__export(utils_exports, {\n  Queue: () => Queue,\n  QueueNode: () => QueueNode,\n  binarySearch: () => binarySearch,\n  insertEventIntoAscendingList: () => insertEventIntoAscendingList,\n  insertEventIntoDescendingList: () => insertEventIntoDescendingList,\n  normalizeURL: () => normalizeURL,\n  utf8Decoder: () => utf8Decoder,\n  utf8Encoder: () => utf8Encoder\n});\nvar utf8Decoder = new TextDecoder(\"utf-8\");\nvar utf8Encoder = new TextEncoder();\nfunction normalizeURL(url) {\n  if (url.indexOf(\"://\") === -1) url = \"wss://\" + url;\n  let p = new URL(url);\n  p.pathname = p.pathname.replace(/\\/+/g, \"/\");\n  if (p.pathname.endsWith(\"/\")) p.pathname = p.pathname.slice(0, -1);\n  if (p.port === \"80\" && p.protocol === \"ws:\" || p.port === \"443\" && p.protocol === \"wss:\") p.port = \"\";\n  p.searchParams.sort();\n  p.hash = \"\";\n  return p.toString();\n}\nfunction insertEventIntoDescendingList(sortedArray, event) {\n  const [idx, found] = binarySearch(sortedArray, b => {\n    if (event.id === b.id) return 0;\n    if (event.created_at === b.created_at) return -1;\n    return b.created_at - event.created_at;\n  });\n  if (!found) {\n    sortedArray.splice(idx, 0, event);\n  }\n  return sortedArray;\n}\nfunction insertEventIntoAscendingList(sortedArray, event) {\n  const [idx, found] = binarySearch(sortedArray, b => {\n    if (event.id === b.id) return 0;\n    if (event.created_at === b.created_at) return -1;\n    return event.created_at - b.created_at;\n  });\n  if (!found) {\n    sortedArray.splice(idx, 0, event);\n  }\n  return sortedArray;\n}\nfunction binarySearch(arr, compare) {\n  let start = 0;\n  let end = arr.length - 1;\n  while (start <= end) {\n    const mid = Math.floor((start + end) / 2);\n    const cmp = compare(arr[mid]);\n    if (cmp === 0) {\n      return [mid, true];\n    }\n    if (cmp < 0) {\n      end = mid - 1;\n    } else {\n      start = mid + 1;\n    }\n  }\n  return [start, false];\n}\nvar QueueNode = class QueueNode {\n  constructor(message) {\n    _defineProperty(this, \"value\", void 0);\n    _defineProperty(this, \"next\", null);\n    _defineProperty(this, \"prev\", null);\n    this.value = message;\n  }\n};\nvar Queue = class Queue {\n  constructor() {\n    _defineProperty(this, \"first\", void 0);\n    _defineProperty(this, \"last\", void 0);\n    this.first = null;\n    this.last = null;\n  }\n  enqueue(value) {\n    const newNode = new QueueNode(value);\n    if (!this.last) {\n      this.first = newNode;\n      this.last = newNode;\n    } else if (this.last === this.first) {\n      this.last = newNode;\n      this.last.prev = this.first;\n      this.first.next = newNode;\n    } else {\n      newNode.prev = this.last;\n      this.last.next = newNode;\n      this.last = newNode;\n    }\n    return true;\n  }\n  dequeue() {\n    if (!this.first) return null;\n    if (this.first === this.last) {\n      const target2 = this.first;\n      this.first = null;\n      this.last = null;\n      return target2.value;\n    }\n    const target = this.first;\n    this.first = target.next;\n    return target.value;\n  }\n};\n\n// pure.ts\nvar JS = class {\n  generateSecretKey() {\n    return schnorr.utils.randomPrivateKey();\n  }\n  getPublicKey(secretKey) {\n    return bytesToHex(schnorr.getPublicKey(secretKey));\n  }\n  finalizeEvent(t, secretKey) {\n    const event = t;\n    event.pubkey = bytesToHex(schnorr.getPublicKey(secretKey));\n    event.id = getEventHash(event);\n    event.sig = bytesToHex(schnorr.sign(getEventHash(event), secretKey));\n    event[verifiedSymbol] = true;\n    return event;\n  }\n  verifyEvent(event) {\n    if (typeof event[verifiedSymbol] === \"boolean\") return event[verifiedSymbol];\n    const hash = getEventHash(event);\n    if (hash !== event.id) {\n      event[verifiedSymbol] = false;\n      return false;\n    }\n    try {\n      const valid = schnorr.verify(event.sig, hash, event.pubkey);\n      event[verifiedSymbol] = valid;\n      return valid;\n    } catch (err) {\n      event[verifiedSymbol] = false;\n      return false;\n    }\n  }\n};\nfunction serializeEvent(evt) {\n  if (!validateEvent(evt)) throw new Error(\"can't serialize event with wrong or missing properties\");\n  return JSON.stringify([0, evt.pubkey, evt.created_at, evt.kind, evt.tags, evt.content]);\n}\nfunction getEventHash(event) {\n  let eventHash = sha256(utf8Encoder.encode(serializeEvent(event)));\n  return bytesToHex(eventHash);\n}\nvar i = new JS();\nvar generateSecretKey = i.generateSecretKey;\nvar getPublicKey = i.getPublicKey;\nvar finalizeEvent = i.finalizeEvent;\nvar verifyEvent = i.verifyEvent;\n\n// kinds.ts\nvar kinds_exports = {};\n__export(kinds_exports, {\n  Application: () => Application,\n  BadgeAward: () => BadgeAward,\n  BadgeDefinition: () => BadgeDefinition,\n  BlockedRelaysList: () => BlockedRelaysList,\n  BookmarkList: () => BookmarkList,\n  Bookmarksets: () => Bookmarksets,\n  Calendar: () => Calendar,\n  CalendarEventRSVP: () => CalendarEventRSVP,\n  ChannelCreation: () => ChannelCreation,\n  ChannelHideMessage: () => ChannelHideMessage,\n  ChannelMessage: () => ChannelMessage,\n  ChannelMetadata: () => ChannelMetadata,\n  ChannelMuteUser: () => ChannelMuteUser,\n  ClassifiedListing: () => ClassifiedListing,\n  ClientAuth: () => ClientAuth,\n  CommunitiesList: () => CommunitiesList,\n  CommunityDefinition: () => CommunityDefinition,\n  CommunityPostApproval: () => CommunityPostApproval,\n  Contacts: () => Contacts,\n  CreateOrUpdateProduct: () => CreateOrUpdateProduct,\n  CreateOrUpdateStall: () => CreateOrUpdateStall,\n  Curationsets: () => Curationsets,\n  Date: () => Date2,\n  DraftClassifiedListing: () => DraftClassifiedListing,\n  DraftLong: () => DraftLong,\n  Emojisets: () => Emojisets,\n  EncryptedDirectMessage: () => EncryptedDirectMessage,\n  EncryptedDirectMessages: () => EncryptedDirectMessages,\n  EventDeletion: () => EventDeletion,\n  FileMetadata: () => FileMetadata,\n  FileServerPreference: () => FileServerPreference,\n  Followsets: () => Followsets,\n  GenericRepost: () => GenericRepost,\n  Genericlists: () => Genericlists,\n  HTTPAuth: () => HTTPAuth,\n  Handlerinformation: () => Handlerinformation,\n  Handlerrecommendation: () => Handlerrecommendation,\n  Highlights: () => Highlights,\n  InterestsList: () => InterestsList,\n  Interestsets: () => Interestsets,\n  JobFeedback: () => JobFeedback,\n  JobRequest: () => JobRequest,\n  JobResult: () => JobResult,\n  Label: () => Label,\n  LightningPubRPC: () => LightningPubRPC,\n  LiveChatMessage: () => LiveChatMessage,\n  LiveEvent: () => LiveEvent,\n  LongFormArticle: () => LongFormArticle,\n  Metadata: () => Metadata,\n  Mutelist: () => Mutelist,\n  NWCWalletInfo: () => NWCWalletInfo,\n  NWCWalletRequest: () => NWCWalletRequest,\n  NWCWalletResponse: () => NWCWalletResponse,\n  NostrConnect: () => NostrConnect,\n  OpenTimestamps: () => OpenTimestamps,\n  Pinlist: () => Pinlist,\n  ProblemTracker: () => ProblemTracker,\n  ProfileBadges: () => ProfileBadges,\n  PublicChatsList: () => PublicChatsList,\n  Reaction: () => Reaction,\n  RecommendRelay: () => RecommendRelay,\n  RelayList: () => RelayList,\n  Relaysets: () => Relaysets,\n  Report: () => Report,\n  Reporting: () => Reporting,\n  Repost: () => Repost,\n  SearchRelaysList: () => SearchRelaysList,\n  ShortTextNote: () => ShortTextNote,\n  Time: () => Time,\n  UserEmojiList: () => UserEmojiList,\n  UserStatuses: () => UserStatuses,\n  Zap: () => Zap,\n  ZapGoal: () => ZapGoal,\n  ZapRequest: () => ZapRequest,\n  classifyKind: () => classifyKind,\n  isEphemeralKind: () => isEphemeralKind,\n  isParameterizedReplaceableKind: () => isParameterizedReplaceableKind,\n  isRegularKind: () => isRegularKind,\n  isReplaceableKind: () => isReplaceableKind\n});\nfunction isRegularKind(kind) {\n  return 1e3 <= kind && kind < 1e4 || [1, 2, 4, 5, 6, 7, 8, 16, 40, 41, 42, 43, 44].includes(kind);\n}\nfunction isReplaceableKind(kind) {\n  return [0, 3].includes(kind) || 1e4 <= kind && kind < 2e4;\n}\nfunction isEphemeralKind(kind) {\n  return 2e4 <= kind && kind < 3e4;\n}\nfunction isParameterizedReplaceableKind(kind) {\n  return 3e4 <= kind && kind < 4e4;\n}\nfunction classifyKind(kind) {\n  if (isRegularKind(kind)) return \"regular\";\n  if (isReplaceableKind(kind)) return \"replaceable\";\n  if (isEphemeralKind(kind)) return \"ephemeral\";\n  if (isParameterizedReplaceableKind(kind)) return \"parameterized\";\n  return \"unknown\";\n}\nvar Metadata = 0;\nvar ShortTextNote = 1;\nvar RecommendRelay = 2;\nvar Contacts = 3;\nvar EncryptedDirectMessage = 4;\nvar EncryptedDirectMessages = 4;\nvar EventDeletion = 5;\nvar Repost = 6;\nvar Reaction = 7;\nvar BadgeAward = 8;\nvar GenericRepost = 16;\nvar ChannelCreation = 40;\nvar ChannelMetadata = 41;\nvar ChannelMessage = 42;\nvar ChannelHideMessage = 43;\nvar ChannelMuteUser = 44;\nvar OpenTimestamps = 1040;\nvar FileMetadata = 1063;\nvar LiveChatMessage = 1311;\nvar ProblemTracker = 1971;\nvar Report = 1984;\nvar Reporting = 1984;\nvar Label = 1985;\nvar CommunityPostApproval = 4550;\nvar JobRequest = 5999;\nvar JobResult = 6999;\nvar JobFeedback = 7e3;\nvar ZapGoal = 9041;\nvar ZapRequest = 9734;\nvar Zap = 9735;\nvar Highlights = 9802;\nvar Mutelist = 1e4;\nvar Pinlist = 10001;\nvar RelayList = 10002;\nvar BookmarkList = 10003;\nvar CommunitiesList = 10004;\nvar PublicChatsList = 10005;\nvar BlockedRelaysList = 10006;\nvar SearchRelaysList = 10007;\nvar InterestsList = 10015;\nvar UserEmojiList = 10030;\nvar FileServerPreference = 10096;\nvar NWCWalletInfo = 13194;\nvar LightningPubRPC = 21e3;\nvar ClientAuth = 22242;\nvar NWCWalletRequest = 23194;\nvar NWCWalletResponse = 23195;\nvar NostrConnect = 24133;\nvar HTTPAuth = 27235;\nvar Followsets = 3e4;\nvar Genericlists = 30001;\nvar Relaysets = 30002;\nvar Bookmarksets = 30003;\nvar Curationsets = 30004;\nvar ProfileBadges = 30008;\nvar BadgeDefinition = 30009;\nvar Interestsets = 30015;\nvar CreateOrUpdateStall = 30017;\nvar CreateOrUpdateProduct = 30018;\nvar LongFormArticle = 30023;\nvar DraftLong = 30024;\nvar Emojisets = 30030;\nvar Application = 30078;\nvar LiveEvent = 30311;\nvar UserStatuses = 30315;\nvar ClassifiedListing = 30402;\nvar DraftClassifiedListing = 30403;\nvar Date2 = 31922;\nvar Time = 31923;\nvar Calendar = 31924;\nvar CalendarEventRSVP = 31925;\nvar Handlerrecommendation = 31989;\nvar Handlerinformation = 31990;\nvar CommunityDefinition = 34550;\n\n// filter.ts\nfunction matchFilter(filter, event) {\n  if (filter.ids && filter.ids.indexOf(event.id) === -1) {\n    if (!filter.ids.some(prefix => event.id.startsWith(prefix))) {\n      return false;\n    }\n  }\n  if (filter.kinds && filter.kinds.indexOf(event.kind) === -1) return false;\n  if (filter.authors && filter.authors.indexOf(event.pubkey) === -1) {\n    if (!filter.authors.some(prefix => event.pubkey.startsWith(prefix))) {\n      return false;\n    }\n  }\n  for (let f in filter) {\n    if (f[0] === \"#\") {\n      let tagName = f.slice(1);\n      let values = filter[\"#\".concat(tagName)];\n      if (values && !event.tags.find(_ref => {\n        let [t, v] = _ref;\n        return t === f.slice(1) && values.indexOf(v) !== -1;\n      })) return false;\n    }\n  }\n  if (filter.since && event.created_at < filter.since) return false;\n  if (filter.until && event.created_at > filter.until) return false;\n  return true;\n}\nfunction matchFilters(filters, event) {\n  for (let i2 = 0; i2 < filters.length; i2++) {\n    if (matchFilter(filters[i2], event)) return true;\n  }\n  return false;\n}\nfunction mergeFilters() {\n  let result = {};\n  for (let i2 = 0; i2 < arguments.length; i2++) {\n    let filter = i2 < 0 || arguments.length <= i2 ? undefined : arguments[i2];\n    Object.entries(filter).forEach(_ref2 => {\n      let [property, values] = _ref2;\n      if (property === \"kinds\" || property === \"ids\" || property === \"authors\" || property[0] === \"#\") {\n        result[property] = result[property] || [];\n        for (let v = 0; v < values.length; v++) {\n          let value = values[v];\n          if (!result[property].includes(value)) result[property].push(value);\n        }\n      }\n    });\n    if (filter.limit && (!result.limit || filter.limit > result.limit)) result.limit = filter.limit;\n    if (filter.until && (!result.until || filter.until > result.until)) result.until = filter.until;\n    if (filter.since && (!result.since || filter.since < result.since)) result.since = filter.since;\n  }\n  return result;\n}\nfunction getFilterLimit(filter) {\n  var _filter$limit, _filter$ids$length, _filter$ids, _filter$authors, _filter$kinds;\n  if (filter.ids && !filter.ids.length) return 0;\n  if (filter.kinds && !filter.kinds.length) return 0;\n  if (filter.authors && !filter.authors.length) return 0;\n  return Math.min(Math.max(0, (_filter$limit = filter.limit) !== null && _filter$limit !== void 0 ? _filter$limit : Infinity), (_filter$ids$length = (_filter$ids = filter.ids) === null || _filter$ids === void 0 ? void 0 : _filter$ids.length) !== null && _filter$ids$length !== void 0 ? _filter$ids$length : Infinity, (_filter$authors = filter.authors) !== null && _filter$authors !== void 0 && _filter$authors.length && (_filter$kinds = filter.kinds) !== null && _filter$kinds !== void 0 && _filter$kinds.every(kind => isReplaceableKind(kind)) ? filter.authors.length * filter.kinds.length : Infinity);\n}\n\n// fakejson.ts\nvar fakejson_exports = {};\n__export(fakejson_exports, {\n  getHex64: () => getHex64,\n  getInt: () => getInt,\n  getSubscriptionId: () => getSubscriptionId,\n  matchEventId: () => matchEventId,\n  matchEventKind: () => matchEventKind,\n  matchEventPubkey: () => matchEventPubkey\n});\nfunction getHex64(json, field) {\n  let len = field.length + 3;\n  let idx = json.indexOf(\"\\\"\".concat(field, \"\\\":\")) + len;\n  let s = json.slice(idx).indexOf(\"\\\"\") + idx + 1;\n  return json.slice(s, s + 64);\n}\nfunction getInt(json, field) {\n  let len = field.length;\n  let idx = json.indexOf(\"\\\"\".concat(field, \"\\\":\")) + len + 3;\n  let sliced = json.slice(idx);\n  let end = Math.min(sliced.indexOf(\",\"), sliced.indexOf(\"}\"));\n  return parseInt(sliced.slice(0, end), 10);\n}\nfunction getSubscriptionId(json) {\n  let idx = json.slice(0, 22).indexOf(\"\\\"EVENT\\\"\");\n  if (idx === -1) return null;\n  let pstart = json.slice(idx + 7 + 1).indexOf(\"\\\"\");\n  if (pstart === -1) return null;\n  let start = idx + 7 + 1 + pstart;\n  let pend = json.slice(start + 1, 80).indexOf(\"\\\"\");\n  if (pend === -1) return null;\n  let end = start + 1 + pend;\n  return json.slice(start + 1, end);\n}\nfunction matchEventId(json, id) {\n  return id === getHex64(json, \"id\");\n}\nfunction matchEventPubkey(json, pubkey) {\n  return pubkey === getHex64(json, \"pubkey\");\n}\nfunction matchEventKind(json, kind) {\n  return kind === getInt(json, \"kind\");\n}\n\n// nip42.ts\nvar nip42_exports = {};\n__export(nip42_exports, {\n  makeAuthEvent: () => makeAuthEvent\n});\nfunction makeAuthEvent(relayURL, challenge) {\n  return {\n    kind: ClientAuth,\n    created_at: Math.floor(Date.now() / 1e3),\n    tags: [[\"relay\", relayURL], [\"challenge\", challenge]],\n    content: \"\"\n  };\n}\n\n// helpers.ts\nasync function yieldThread() {\n  return new Promise(resolve => {\n    const ch = new MessageChannel();\n    const handler = () => {\n      ch.port1.removeEventListener(\"message\", handler);\n      resolve();\n    };\n    ch.port1.addEventListener(\"message\", handler);\n    ch.port2.postMessage(0);\n    ch.port1.start();\n  });\n}\nvar alwaysTrue = t => {\n  t[verifiedSymbol] = true;\n  return true;\n};\n\n// abstract-relay.ts\nvar AbstractRelay = class AbstractRelay {\n  constructor(url, opts) {\n    _defineProperty(this, \"url\", void 0);\n    _defineProperty(this, \"_connected\", false);\n    _defineProperty(this, \"onclose\", null);\n    _defineProperty(this, \"onnotice\", msg => console.debug(\"NOTICE from \".concat(this.url, \": \").concat(msg)));\n    _defineProperty(this, \"baseEoseTimeout\", 4400);\n    _defineProperty(this, \"connectionTimeout\", 4400);\n    _defineProperty(this, \"openSubs\", /* @__PURE__ */new Map());\n    _defineProperty(this, \"connectionTimeoutHandle\", void 0);\n    _defineProperty(this, \"connectionPromise\", void 0);\n    _defineProperty(this, \"openCountRequests\", /* @__PURE__ */new Map());\n    _defineProperty(this, \"openEventPublishes\", /* @__PURE__ */new Map());\n    _defineProperty(this, \"ws\", void 0);\n    _defineProperty(this, \"incomingMessageQueue\", new Queue());\n    _defineProperty(this, \"queueRunning\", false);\n    _defineProperty(this, \"challenge\", void 0);\n    _defineProperty(this, \"serial\", 0);\n    _defineProperty(this, \"verifyEvent\", void 0);\n    this.url = normalizeURL(url);\n    this.verifyEvent = opts.verifyEvent;\n  }\n  static async connect(url, opts) {\n    const relay = new AbstractRelay(url, opts);\n    await relay.connect();\n    return relay;\n  }\n  closeAllSubscriptions(reason) {\n    for (let [_, sub] of this.openSubs) {\n      sub.close(reason);\n    }\n    this.openSubs.clear();\n    for (let [_, ep] of this.openEventPublishes) {\n      ep.reject(new Error(reason));\n    }\n    this.openEventPublishes.clear();\n    for (let [_, cr] of this.openCountRequests) {\n      cr.reject(new Error(reason));\n    }\n    this.openCountRequests.clear();\n  }\n  get connected() {\n    return this._connected;\n  }\n  async connect() {\n    if (this.connectionPromise) return this.connectionPromise;\n    this.challenge = void 0;\n    this.connectionPromise = new Promise((resolve, reject) => {\n      this.connectionTimeoutHandle = setTimeout(() => {\n        var _this$onclose;\n        reject(\"connection timed out\");\n        this.connectionPromise = void 0;\n        (_this$onclose = this.onclose) === null || _this$onclose === void 0 || _this$onclose.call(this);\n        this.closeAllSubscriptions(\"relay connection timed out\");\n      }, this.connectionTimeout);\n      try {\n        this.ws = new WebSocket(this.url);\n      } catch (err) {\n        reject(err);\n        return;\n      }\n      this.ws.onopen = () => {\n        clearTimeout(this.connectionTimeoutHandle);\n        this._connected = true;\n        resolve();\n      };\n      this.ws.onerror = ev => {\n        reject(ev.message);\n        if (this._connected) {\n          var _this$onclose2;\n          (_this$onclose2 = this.onclose) === null || _this$onclose2 === void 0 || _this$onclose2.call(this);\n          this.closeAllSubscriptions(\"relay connection errored\");\n          this._connected = false;\n        }\n      };\n      this.ws.onclose = async () => {\n        var _this$onclose3;\n        this.connectionPromise = void 0;\n        (_this$onclose3 = this.onclose) === null || _this$onclose3 === void 0 || _this$onclose3.call(this);\n        this.closeAllSubscriptions(\"relay connection closed\");\n        this._connected = false;\n      };\n      this.ws.onmessage = this._onmessage.bind(this);\n    });\n    return this.connectionPromise;\n  }\n  async runQueue() {\n    this.queueRunning = true;\n    while (true) {\n      if (false === this.handleNext()) {\n        break;\n      }\n      await yieldThread();\n    }\n    this.queueRunning = false;\n  }\n  handleNext() {\n    const json = this.incomingMessageQueue.dequeue();\n    if (!json) {\n      return false;\n    }\n    const subid = getSubscriptionId(json);\n    if (subid) {\n      var _so$alreadyHaveEvent, _so$receivedEvent;\n      const so = this.openSubs.get(subid);\n      if (!so) {\n        return;\n      }\n      const id = getHex64(json, \"id\");\n      const alreadyHave = (_so$alreadyHaveEvent = so.alreadyHaveEvent) === null || _so$alreadyHaveEvent === void 0 ? void 0 : _so$alreadyHaveEvent.call(so, id);\n      (_so$receivedEvent = so.receivedEvent) === null || _so$receivedEvent === void 0 || _so$receivedEvent.call(so, this, id);\n      if (alreadyHave) {\n        return;\n      }\n    }\n    try {\n      let data = JSON.parse(json);\n      switch (data[0]) {\n        case \"EVENT\":\n          {\n            const so = this.openSubs.get(data[1]);\n            const event = data[2];\n            if (this.verifyEvent(event) && matchFilters(so.filters, event)) {\n              so.onevent(event);\n            }\n            return;\n          }\n        case \"COUNT\":\n          {\n            const id = data[1];\n            const payload = data[2];\n            const cr = this.openCountRequests.get(id);\n            if (cr) {\n              cr.resolve(payload.count);\n              this.openCountRequests.delete(id);\n            }\n            return;\n          }\n        case \"EOSE\":\n          {\n            const so = this.openSubs.get(data[1]);\n            if (!so) return;\n            so.receivedEose();\n            return;\n          }\n        case \"OK\":\n          {\n            const id = data[1];\n            const ok = data[2];\n            const reason = data[3];\n            const ep = this.openEventPublishes.get(id);\n            if (ok) ep.resolve(reason);else ep.reject(new Error(reason));\n            this.openEventPublishes.delete(id);\n            return;\n          }\n        case \"CLOSED\":\n          {\n            const id = data[1];\n            const so = this.openSubs.get(id);\n            if (!so) return;\n            so.closed = true;\n            so.close(data[2]);\n            return;\n          }\n        case \"NOTICE\":\n          this.onnotice(data[1]);\n          return;\n        case \"AUTH\":\n          {\n            this.challenge = data[1];\n            return;\n          }\n      }\n    } catch (err) {\n      return;\n    }\n  }\n  async send(message) {\n    if (!this.connectionPromise) throw new Error(\"sending on closed connection\");\n    this.connectionPromise.then(() => {\n      var _this$ws;\n      (_this$ws = this.ws) === null || _this$ws === void 0 || _this$ws.send(message);\n    });\n  }\n  async auth(signAuthEvent) {\n    if (!this.challenge) throw new Error(\"can't perform auth, no challenge was received\");\n    const evt = await signAuthEvent(makeAuthEvent(this.url, this.challenge));\n    const ret = new Promise((resolve, reject) => {\n      this.openEventPublishes.set(evt.id, {\n        resolve,\n        reject\n      });\n    });\n    this.send('[\"AUTH\",' + JSON.stringify(evt) + \"]\");\n    return ret;\n  }\n  async publish(event) {\n    const ret = new Promise((resolve, reject) => {\n      this.openEventPublishes.set(event.id, {\n        resolve,\n        reject\n      });\n    });\n    this.send('[\"EVENT\",' + JSON.stringify(event) + \"]\");\n    return ret;\n  }\n  async count(filters, params) {\n    this.serial++;\n    const id = (params === null || params === void 0 ? void 0 : params.id) || \"count:\" + this.serial;\n    const ret = new Promise((resolve, reject) => {\n      this.openCountRequests.set(id, {\n        resolve,\n        reject\n      });\n    });\n    this.send('[\"COUNT\",\"' + id + '\",' + JSON.stringify(filters) + \"]\");\n    return ret;\n  }\n  subscribe(filters, params) {\n    const subscription = this.prepareSubscription(filters, params);\n    subscription.fire();\n    return subscription;\n  }\n  prepareSubscription(filters, params) {\n    this.serial++;\n    const id = params.id || \"sub:\" + this.serial;\n    const subscription = new Subscription(this, id, filters, params);\n    this.openSubs.set(id, subscription);\n    return subscription;\n  }\n  close() {\n    var _this$ws2;\n    this.closeAllSubscriptions(\"relay connection closed by us\");\n    this._connected = false;\n    (_this$ws2 = this.ws) === null || _this$ws2 === void 0 || _this$ws2.close();\n  }\n  _onmessage(ev) {\n    this.incomingMessageQueue.enqueue(ev.data);\n    if (!this.queueRunning) {\n      this.runQueue();\n    }\n  }\n};\nvar Subscription = class Subscription {\n  constructor(relay, id, filters, params) {\n    _defineProperty(this, \"relay\", void 0);\n    _defineProperty(this, \"id\", void 0);\n    _defineProperty(this, \"closed\", false);\n    _defineProperty(this, \"eosed\", false);\n    _defineProperty(this, \"filters\", void 0);\n    _defineProperty(this, \"alreadyHaveEvent\", void 0);\n    _defineProperty(this, \"receivedEvent\", void 0);\n    _defineProperty(this, \"onevent\", void 0);\n    _defineProperty(this, \"oneose\", void 0);\n    _defineProperty(this, \"onclose\", void 0);\n    _defineProperty(this, \"eoseTimeout\", void 0);\n    _defineProperty(this, \"eoseTimeoutHandle\", void 0);\n    this.relay = relay;\n    this.filters = filters;\n    this.id = id;\n    this.alreadyHaveEvent = params.alreadyHaveEvent;\n    this.receivedEvent = params.receivedEvent;\n    this.eoseTimeout = params.eoseTimeout || relay.baseEoseTimeout;\n    this.oneose = params.oneose;\n    this.onclose = params.onclose;\n    this.onevent = params.onevent || (event => {\n      console.warn(\"onevent() callback not defined for subscription '\".concat(this.id, \"' in relay \").concat(this.relay.url, \". event received:\"), event);\n    });\n  }\n  fire() {\n    this.relay.send('[\"REQ\",\"' + this.id + '\",' + JSON.stringify(this.filters).substring(1));\n    this.eoseTimeoutHandle = setTimeout(this.receivedEose.bind(this), this.eoseTimeout);\n  }\n  receivedEose() {\n    var _this$oneose;\n    if (this.eosed) return;\n    clearTimeout(this.eoseTimeoutHandle);\n    this.eosed = true;\n    (_this$oneose = this.oneose) === null || _this$oneose === void 0 || _this$oneose.call(this);\n  }\n  close() {\n    var _this$onclose4;\n    let reason = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"closed by caller\";\n    if (!this.closed) {\n      this.relay.send('[\"CLOSE\",' + JSON.stringify(this.id) + \"]\");\n      this.closed = true;\n    }\n    this.relay.openSubs.delete(this.id);\n    (_this$onclose4 = this.onclose) === null || _this$onclose4 === void 0 || _this$onclose4.call(this, reason);\n  }\n};\n\n// relay.ts\nfunction relayConnect(url) {\n  return Relay.connect(url);\n}\nvar Relay = class extends AbstractRelay {\n  constructor(url) {\n    super(url, {\n      verifyEvent\n    });\n  }\n  static async connect(url) {\n    const relay = new Relay(url);\n    await relay.connect();\n    return relay;\n  }\n};\n\n// abstract-pool.ts\nvar AbstractSimplePool = class AbstractSimplePool {\n  constructor(opts) {\n    _defineProperty(this, \"relays\", /* @__PURE__ */new Map());\n    _defineProperty(this, \"seenOn\", /* @__PURE__ */new Map());\n    _defineProperty(this, \"trackRelays\", false);\n    _defineProperty(this, \"verifyEvent\", void 0);\n    _defineProperty(this, \"trustedRelayURLs\", /* @__PURE__ */new Set());\n    this.verifyEvent = opts.verifyEvent;\n  }\n  async ensureRelay(url, params) {\n    url = normalizeURL(url);\n    let relay = this.relays.get(url);\n    if (!relay) {\n      relay = new AbstractRelay(url, {\n        verifyEvent: this.trustedRelayURLs.has(url) ? alwaysTrue : this.verifyEvent\n      });\n      if (params !== null && params !== void 0 && params.connectionTimeout) relay.connectionTimeout = params.connectionTimeout;\n      this.relays.set(url, relay);\n    }\n    await relay.connect();\n    return relay;\n  }\n  close(relays) {\n    relays.map(normalizeURL).forEach(url => {\n      var _this$relays$get;\n      (_this$relays$get = this.relays.get(url)) === null || _this$relays$get === void 0 || _this$relays$get.close();\n    });\n  }\n  subscribeMany(relays, filters, params) {\n    if (this.trackRelays) {\n      params.receivedEvent = (relay, id) => {\n        let set = this.seenOn.get(id);\n        if (!set) {\n          set = /* @__PURE__ */new Set();\n          this.seenOn.set(id, set);\n        }\n        set.add(relay);\n      };\n    }\n    const _knownIds = /* @__PURE__ */new Set();\n    const subs = [];\n    const eosesReceived = [];\n    let handleEose = i2 => {\n      eosesReceived[i2] = true;\n      if (eosesReceived.filter(a => a).length === relays.length) {\n        var _params$oneose;\n        (_params$oneose = params.oneose) === null || _params$oneose === void 0 || _params$oneose.call(params);\n        handleEose = () => {};\n      }\n    };\n    const closesReceived = [];\n    let handleClose = (i2, reason) => {\n      handleEose(i2);\n      closesReceived[i2] = reason;\n      if (closesReceived.filter(a => a).length === relays.length) {\n        var _params$onclose;\n        (_params$onclose = params.onclose) === null || _params$onclose === void 0 || _params$onclose.call(params, closesReceived);\n        handleClose = () => {};\n      }\n    };\n    const localAlreadyHaveEventHandler = id => {\n      var _params$alreadyHaveEv;\n      if ((_params$alreadyHaveEv = params.alreadyHaveEvent) !== null && _params$alreadyHaveEv !== void 0 && _params$alreadyHaveEv.call(params, id)) {\n        return true;\n      }\n      const have = _knownIds.has(id);\n      _knownIds.add(id);\n      return have;\n    };\n    const allOpened = Promise.all(relays.map(normalizeURL).map(async (url, i2, arr) => {\n      if (arr.indexOf(url) !== i2) {\n        handleClose(i2, \"duplicate url\");\n        return;\n      }\n      let relay;\n      try {\n        relay = await this.ensureRelay(url, {\n          connectionTimeout: params.maxWait ? Math.max(params.maxWait * 0.8, params.maxWait - 1e3) : void 0\n        });\n      } catch (err) {\n        handleClose(i2, (err === null || err === void 0 ? void 0 : err.message) || String(err));\n        return;\n      }\n      let subscription = relay.subscribe(filters, {\n        ...params,\n        oneose: () => handleEose(i2),\n        onclose: reason => handleClose(i2, reason),\n        alreadyHaveEvent: localAlreadyHaveEventHandler,\n        eoseTimeout: params.maxWait\n      });\n      subs.push(subscription);\n    }));\n    return {\n      async close() {\n        await allOpened;\n        subs.forEach(sub => {\n          sub.close();\n        });\n      }\n    };\n  }\n  subscribeManyEose(relays, filters, params) {\n    const subcloser = this.subscribeMany(relays, filters, {\n      ...params,\n      oneose() {\n        subcloser.close();\n      }\n    });\n    return subcloser;\n  }\n  async querySync(relays, filter, params) {\n    return new Promise(async resolve => {\n      const events = [];\n      this.subscribeManyEose(relays, [filter], {\n        ...params,\n        onevent(event) {\n          events.push(event);\n        },\n        onclose(_) {\n          resolve(events);\n        }\n      });\n    });\n  }\n  async get(relays, filter, params) {\n    filter.limit = 1;\n    const events = await this.querySync(relays, filter, params);\n    events.sort((a, b) => b.created_at - a.created_at);\n    return events[0] || null;\n  }\n  publish(relays, event) {\n    return relays.map(normalizeURL).map(async (url, i2, arr) => {\n      if (arr.indexOf(url) !== i2) {\n        return Promise.reject(\"duplicate url\");\n      }\n      let r = await this.ensureRelay(url);\n      return r.publish(event);\n    });\n  }\n};\n\n// pool.ts\nvar SimplePool = class extends AbstractSimplePool {\n  constructor() {\n    super({\n      verifyEvent\n    });\n  }\n};\n\n// nip19.ts\nvar nip19_exports = {};\n__export(nip19_exports, {\n  BECH32_REGEX: () => BECH32_REGEX,\n  decode: () => decode,\n  naddrEncode: () => naddrEncode,\n  neventEncode: () => neventEncode,\n  noteEncode: () => noteEncode,\n  nprofileEncode: () => nprofileEncode,\n  npubEncode: () => npubEncode,\n  nrelayEncode: () => nrelayEncode,\n  nsecEncode: () => nsecEncode\n});\nimport { bytesToHex as bytesToHex2, concatBytes, hexToBytes } from \"@noble/hashes/utils\";\nimport { bech32 } from \"@scure/base\";\nvar Bech32MaxSize = 5e3;\nvar BECH32_REGEX = /[\\x21-\\x7E]{1,83}1[023456789acdefghjklmnpqrstuvwxyz]{6,}/;\nfunction integerToUint8Array(number) {\n  const uint8Array = new Uint8Array(4);\n  uint8Array[0] = number >> 24 & 255;\n  uint8Array[1] = number >> 16 & 255;\n  uint8Array[2] = number >> 8 & 255;\n  uint8Array[3] = number & 255;\n  return uint8Array;\n}\nfunction decode(nip19) {\n  let {\n    prefix,\n    words\n  } = bech32.decode(nip19, Bech32MaxSize);\n  let data = new Uint8Array(bech32.fromWords(words));\n  switch (prefix) {\n    case \"nprofile\":\n      {\n        var _tlv$;\n        let tlv = parseTLV(data);\n        if (!((_tlv$ = tlv[0]) !== null && _tlv$ !== void 0 && _tlv$[0])) throw new Error(\"missing TLV 0 for nprofile\");\n        if (tlv[0][0].length !== 32) throw new Error(\"TLV 0 should be 32 bytes\");\n        return {\n          type: \"nprofile\",\n          data: {\n            pubkey: bytesToHex2(tlv[0][0]),\n            relays: tlv[1] ? tlv[1].map(d => utf8Decoder.decode(d)) : []\n          }\n        };\n      }\n    case \"nevent\":\n      {\n        var _tlv$2, _tlv$3, _tlv$4;\n        let tlv = parseTLV(data);\n        if (!((_tlv$2 = tlv[0]) !== null && _tlv$2 !== void 0 && _tlv$2[0])) throw new Error(\"missing TLV 0 for nevent\");\n        if (tlv[0][0].length !== 32) throw new Error(\"TLV 0 should be 32 bytes\");\n        if (tlv[2] && tlv[2][0].length !== 32) throw new Error(\"TLV 2 should be 32 bytes\");\n        if (tlv[3] && tlv[3][0].length !== 4) throw new Error(\"TLV 3 should be 4 bytes\");\n        return {\n          type: \"nevent\",\n          data: {\n            id: bytesToHex2(tlv[0][0]),\n            relays: tlv[1] ? tlv[1].map(d => utf8Decoder.decode(d)) : [],\n            author: (_tlv$3 = tlv[2]) !== null && _tlv$3 !== void 0 && _tlv$3[0] ? bytesToHex2(tlv[2][0]) : void 0,\n            kind: (_tlv$4 = tlv[3]) !== null && _tlv$4 !== void 0 && _tlv$4[0] ? parseInt(bytesToHex2(tlv[3][0]), 16) : void 0\n          }\n        };\n      }\n    case \"naddr\":\n      {\n        var _tlv$5, _tlv$6, _tlv$7;\n        let tlv = parseTLV(data);\n        if (!((_tlv$5 = tlv[0]) !== null && _tlv$5 !== void 0 && _tlv$5[0])) throw new Error(\"missing TLV 0 for naddr\");\n        if (!((_tlv$6 = tlv[2]) !== null && _tlv$6 !== void 0 && _tlv$6[0])) throw new Error(\"missing TLV 2 for naddr\");\n        if (tlv[2][0].length !== 32) throw new Error(\"TLV 2 should be 32 bytes\");\n        if (!((_tlv$7 = tlv[3]) !== null && _tlv$7 !== void 0 && _tlv$7[0])) throw new Error(\"missing TLV 3 for naddr\");\n        if (tlv[3][0].length !== 4) throw new Error(\"TLV 3 should be 4 bytes\");\n        return {\n          type: \"naddr\",\n          data: {\n            identifier: utf8Decoder.decode(tlv[0][0]),\n            pubkey: bytesToHex2(tlv[2][0]),\n            kind: parseInt(bytesToHex2(tlv[3][0]), 16),\n            relays: tlv[1] ? tlv[1].map(d => utf8Decoder.decode(d)) : []\n          }\n        };\n      }\n    case \"nrelay\":\n      {\n        var _tlv$8;\n        let tlv = parseTLV(data);\n        if (!((_tlv$8 = tlv[0]) !== null && _tlv$8 !== void 0 && _tlv$8[0])) throw new Error(\"missing TLV 0 for nrelay\");\n        return {\n          type: \"nrelay\",\n          data: utf8Decoder.decode(tlv[0][0])\n        };\n      }\n    case \"nsec\":\n      return {\n        type: prefix,\n        data\n      };\n    case \"npub\":\n    case \"note\":\n      return {\n        type: prefix,\n        data: bytesToHex2(data)\n      };\n    default:\n      throw new Error(\"unknown prefix \".concat(prefix));\n  }\n}\nfunction parseTLV(data) {\n  let result = {};\n  let rest = data;\n  while (rest.length > 0) {\n    let t = rest[0];\n    let l = rest[1];\n    let v = rest.slice(2, 2 + l);\n    rest = rest.slice(2 + l);\n    if (v.length < l) throw new Error(\"not enough data to read on TLV \".concat(t));\n    result[t] = result[t] || [];\n    result[t].push(v);\n  }\n  return result;\n}\nfunction nsecEncode(key) {\n  return encodeBytes(\"nsec\", key);\n}\nfunction npubEncode(hex) {\n  return encodeBytes(\"npub\", hexToBytes(hex));\n}\nfunction noteEncode(hex) {\n  return encodeBytes(\"note\", hexToBytes(hex));\n}\nfunction encodeBech32(prefix, data) {\n  let words = bech32.toWords(data);\n  return bech32.encode(prefix, words, Bech32MaxSize);\n}\nfunction encodeBytes(prefix, bytes) {\n  return encodeBech32(prefix, bytes);\n}\nfunction nprofileEncode(profile) {\n  let data = encodeTLV({\n    0: [hexToBytes(profile.pubkey)],\n    1: (profile.relays || []).map(url => utf8Encoder.encode(url))\n  });\n  return encodeBech32(\"nprofile\", data);\n}\nfunction neventEncode(event) {\n  let kindArray;\n  if (event.kind !== void 0) {\n    kindArray = integerToUint8Array(event.kind);\n  }\n  let data = encodeTLV({\n    0: [hexToBytes(event.id)],\n    1: (event.relays || []).map(url => utf8Encoder.encode(url)),\n    2: event.author ? [hexToBytes(event.author)] : [],\n    3: kindArray ? [new Uint8Array(kindArray)] : []\n  });\n  return encodeBech32(\"nevent\", data);\n}\nfunction naddrEncode(addr) {\n  let kind = new ArrayBuffer(4);\n  new DataView(kind).setUint32(0, addr.kind, false);\n  let data = encodeTLV({\n    0: [utf8Encoder.encode(addr.identifier)],\n    1: (addr.relays || []).map(url => utf8Encoder.encode(url)),\n    2: [hexToBytes(addr.pubkey)],\n    3: [new Uint8Array(kind)]\n  });\n  return encodeBech32(\"naddr\", data);\n}\nfunction nrelayEncode(url) {\n  let data = encodeTLV({\n    0: [utf8Encoder.encode(url)]\n  });\n  return encodeBech32(\"nrelay\", data);\n}\nfunction encodeTLV(tlv) {\n  let entries = [];\n  Object.entries(tlv).reverse().forEach(_ref3 => {\n    let [t, vs] = _ref3;\n    vs.forEach(v => {\n      let entry = new Uint8Array(v.length + 2);\n      entry.set([parseInt(t)], 0);\n      entry.set([v.length], 1);\n      entry.set(v, 2);\n      entries.push(entry);\n    });\n  });\n  return concatBytes(...entries);\n}\n\n// references.ts\nvar mentionRegex = /\\bnostr:((note|npub|naddr|nevent|nprofile)1\\w+)\\b|#\\[(\\d+)\\]/g;\nfunction parseReferences(evt) {\n  let references = [];\n  for (let ref of evt.content.matchAll(mentionRegex)) {\n    if (ref[2]) {\n      try {\n        let {\n          type,\n          data\n        } = decode(ref[1]);\n        switch (type) {\n          case \"npub\":\n            {\n              references.push({\n                text: ref[0],\n                profile: {\n                  pubkey: data,\n                  relays: []\n                }\n              });\n              break;\n            }\n          case \"nprofile\":\n            {\n              references.push({\n                text: ref[0],\n                profile: data\n              });\n              break;\n            }\n          case \"note\":\n            {\n              references.push({\n                text: ref[0],\n                event: {\n                  id: data,\n                  relays: []\n                }\n              });\n              break;\n            }\n          case \"nevent\":\n            {\n              references.push({\n                text: ref[0],\n                event: data\n              });\n              break;\n            }\n          case \"naddr\":\n            {\n              references.push({\n                text: ref[0],\n                address: data\n              });\n              break;\n            }\n        }\n      } catch (err) {}\n    } else if (ref[3]) {\n      let idx = parseInt(ref[3], 10);\n      let tag = evt.tags[idx];\n      if (!tag) continue;\n      switch (tag[0]) {\n        case \"p\":\n          {\n            references.push({\n              text: ref[0],\n              profile: {\n                pubkey: tag[1],\n                relays: tag[2] ? [tag[2]] : []\n              }\n            });\n            break;\n          }\n        case \"e\":\n          {\n            references.push({\n              text: ref[0],\n              event: {\n                id: tag[1],\n                relays: tag[2] ? [tag[2]] : []\n              }\n            });\n            break;\n          }\n        case \"a\":\n          {\n            try {\n              let [kind, pubkey, identifier] = tag[1].split(\":\");\n              references.push({\n                text: ref[0],\n                address: {\n                  identifier,\n                  pubkey,\n                  kind: parseInt(kind, 10),\n                  relays: tag[2] ? [tag[2]] : []\n                }\n              });\n            } catch (err) {}\n            break;\n          }\n      }\n    }\n  }\n  return references;\n}\n\n// nip04.ts\nvar nip04_exports = {};\n__export(nip04_exports, {\n  decrypt: () => decrypt,\n  encrypt: () => encrypt\n});\nimport { bytesToHex as bytesToHex3, randomBytes } from \"@noble/hashes/utils\";\nimport { secp256k1 } from \"@noble/curves/secp256k1\";\nimport { base64 } from \"@scure/base\";\nif (typeof crypto !== \"undefined\" && !crypto.subtle && crypto.webcrypto) {\n  crypto.subtle = crypto.webcrypto.subtle;\n}\nasync function encrypt(secretKey, pubkey, text) {\n  const privkey = secretKey instanceof Uint8Array ? bytesToHex3(secretKey) : secretKey;\n  const key = secp256k1.getSharedSecret(privkey, \"02\" + pubkey);\n  const normalizedKey = getNormalizedX(key);\n  let iv = Uint8Array.from(randomBytes(16));\n  let plaintext = utf8Encoder.encode(text);\n  let cryptoKey = await crypto.subtle.importKey(\"raw\", normalizedKey, {\n    name: \"AES-CBC\"\n  }, false, [\"encrypt\"]);\n  let ciphertext = await crypto.subtle.encrypt({\n    name: \"AES-CBC\",\n    iv\n  }, cryptoKey, plaintext);\n  let ctb64 = base64.encode(new Uint8Array(ciphertext));\n  let ivb64 = base64.encode(new Uint8Array(iv.buffer));\n  return \"\".concat(ctb64, \"?iv=\").concat(ivb64);\n}\nasync function decrypt(secretKey, pubkey, data) {\n  const privkey = secretKey instanceof Uint8Array ? bytesToHex3(secretKey) : secretKey;\n  let [ctb64, ivb64] = data.split(\"?iv=\");\n  let key = secp256k1.getSharedSecret(privkey, \"02\" + pubkey);\n  let normalizedKey = getNormalizedX(key);\n  let cryptoKey = await crypto.subtle.importKey(\"raw\", normalizedKey, {\n    name: \"AES-CBC\"\n  }, false, [\"decrypt\"]);\n  let ciphertext = base64.decode(ctb64);\n  let iv = base64.decode(ivb64);\n  let plaintext = await crypto.subtle.decrypt({\n    name: \"AES-CBC\",\n    iv\n  }, cryptoKey, ciphertext);\n  let text = utf8Decoder.decode(plaintext);\n  return text;\n}\nfunction getNormalizedX(key) {\n  return key.slice(1, 33);\n}\n\n// nip05.ts\nvar nip05_exports = {};\n__export(nip05_exports, {\n  NIP05_REGEX: () => NIP05_REGEX,\n  queryProfile: () => queryProfile,\n  searchDomain: () => searchDomain,\n  useFetchImplementation: () => useFetchImplementation\n});\nvar NIP05_REGEX = /^(?:([\\w.+-]+)@)?([\\w.-]+)$/;\nvar _fetch;\ntry {\n  _fetch = fetch;\n} catch {}\nfunction useFetchImplementation(fetchImplementation) {\n  _fetch = fetchImplementation;\n}\nasync function searchDomain(domain) {\n  let query = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"\";\n  try {\n    let res = await (await _fetch(\"https://\".concat(domain, \"/.well-known/nostr.json?name=\").concat(query))).json();\n    return res.names;\n  } catch (_) {\n    return {};\n  }\n}\nasync function queryProfile(fullname) {\n  const match = fullname.match(NIP05_REGEX);\n  if (!match) return null;\n  const [_, name = \"_\", domain] = match;\n  try {\n    const res = await _fetch(\"https://\".concat(domain, \"/.well-known/nostr.json?name=\").concat(name));\n    const {\n      names,\n      relays\n    } = parseNIP05Result(await res.json());\n    const pubkey = names[name];\n    return pubkey ? {\n      pubkey,\n      relays: relays === null || relays === void 0 ? void 0 : relays[pubkey]\n    } : null;\n  } catch (_e) {\n    return null;\n  }\n}\nfunction parseNIP05Result(json) {\n  const result = {\n    names: {}\n  };\n  for (const [name, pubkey] of Object.entries(json.names)) {\n    if (typeof name === \"string\" && typeof pubkey === \"string\") {\n      result.names[name] = pubkey;\n    }\n  }\n  if (json.relays) {\n    result.relays = {};\n    for (const [pubkey, relays] of Object.entries(json.relays)) {\n      if (typeof pubkey === \"string\" && Array.isArray(relays)) {\n        result.relays[pubkey] = relays.filter(relay => typeof relay === \"string\");\n      }\n    }\n  }\n  return result;\n}\n\n// nip10.ts\nvar nip10_exports = {};\n__export(nip10_exports, {\n  parse: () => parse\n});\nfunction parse(event) {\n  const result = {\n    reply: void 0,\n    root: void 0,\n    mentions: [],\n    profiles: []\n  };\n  const eTags = [];\n  for (const tag of event.tags) {\n    if (tag[0] === \"e\" && tag[1]) {\n      eTags.push(tag);\n    }\n    if (tag[0] === \"p\" && tag[1]) {\n      result.profiles.push({\n        pubkey: tag[1],\n        relays: tag[2] ? [tag[2]] : []\n      });\n    }\n  }\n  for (let eTagIndex = 0; eTagIndex < eTags.length; eTagIndex++) {\n    const eTag = eTags[eTagIndex];\n    const [_, eTagEventId, eTagRelayUrl, eTagMarker] = eTag;\n    const eventPointer = {\n      id: eTagEventId,\n      relays: eTagRelayUrl ? [eTagRelayUrl] : []\n    };\n    const isFirstETag = eTagIndex === 0;\n    const isLastETag = eTagIndex === eTags.length - 1;\n    if (eTagMarker === \"root\") {\n      result.root = eventPointer;\n      continue;\n    }\n    if (eTagMarker === \"reply\") {\n      result.reply = eventPointer;\n      continue;\n    }\n    if (eTagMarker === \"mention\") {\n      result.mentions.push(eventPointer);\n      continue;\n    }\n    if (isFirstETag) {\n      result.root = eventPointer;\n      continue;\n    }\n    if (isLastETag) {\n      result.reply = eventPointer;\n      continue;\n    }\n    result.mentions.push(eventPointer);\n  }\n  return result;\n}\n\n// nip11.ts\nvar nip11_exports = {};\n__export(nip11_exports, {\n  fetchRelayInformation: () => fetchRelayInformation,\n  useFetchImplementation: () => useFetchImplementation2\n});\nvar _fetch2;\ntry {\n  _fetch2 = fetch;\n} catch {}\nfunction useFetchImplementation2(fetchImplementation) {\n  _fetch2 = fetchImplementation;\n}\nasync function fetchRelayInformation(url) {\n  return await (await fetch(url.replace(\"ws://\", \"http://\").replace(\"wss://\", \"https://\"), {\n    headers: {\n      Accept: \"application/nostr+json\"\n    }\n  })).json();\n}\n\n// nip13.ts\nvar nip13_exports = {};\n__export(nip13_exports, {\n  getPow: () => getPow,\n  minePow: () => minePow\n});\nfunction getPow(hex) {\n  let count = 0;\n  for (let i2 = 0; i2 < hex.length; i2++) {\n    const nibble = parseInt(hex[i2], 16);\n    if (nibble === 0) {\n      count += 4;\n    } else {\n      count += Math.clz32(nibble) - 28;\n      break;\n    }\n  }\n  return count;\n}\nfunction minePow(unsigned, difficulty) {\n  let count = 0;\n  const event = unsigned;\n  const tag = [\"nonce\", count.toString(), difficulty.toString()];\n  event.tags.push(tag);\n  while (true) {\n    const now = Math.floor(new Date().getTime() / 1e3);\n    if (now !== event.created_at) {\n      count = 0;\n      event.created_at = now;\n    }\n    tag[1] = (++count).toString();\n    event.id = getEventHash(event);\n    if (getPow(event.id) >= difficulty) {\n      break;\n    }\n  }\n  return event;\n}\n\n// nip18.ts\nvar nip18_exports = {};\n__export(nip18_exports, {\n  finishRepostEvent: () => finishRepostEvent,\n  getRepostedEvent: () => getRepostedEvent,\n  getRepostedEventPointer: () => getRepostedEventPointer\n});\nfunction finishRepostEvent(t, reposted, relayUrl, privateKey) {\n  var _t$tags;\n  return finalizeEvent({\n    kind: Repost,\n    tags: [...((_t$tags = t.tags) !== null && _t$tags !== void 0 ? _t$tags : []), [\"e\", reposted.id, relayUrl], [\"p\", reposted.pubkey]],\n    content: t.content === \"\" ? \"\" : JSON.stringify(reposted),\n    created_at: t.created_at\n  }, privateKey);\n}\nfunction getRepostedEventPointer(event) {\n  var _lastPTag, _lastPTag2;\n  if (event.kind !== Repost) {\n    return void 0;\n  }\n  let lastETag;\n  let lastPTag;\n  for (let i2 = event.tags.length - 1; i2 >= 0 && (lastETag === void 0 || lastPTag === void 0); i2--) {\n    const tag = event.tags[i2];\n    if (tag.length >= 2) {\n      if (tag[0] === \"e\" && lastETag === void 0) {\n        lastETag = tag;\n      } else if (tag[0] === \"p\" && lastPTag === void 0) {\n        lastPTag = tag;\n      }\n    }\n  }\n  if (lastETag === void 0) {\n    return void 0;\n  }\n  return {\n    id: lastETag[1],\n    relays: [lastETag[2], (_lastPTag = lastPTag) === null || _lastPTag === void 0 ? void 0 : _lastPTag[2]].filter(x => typeof x === \"string\"),\n    author: (_lastPTag2 = lastPTag) === null || _lastPTag2 === void 0 ? void 0 : _lastPTag2[1]\n  };\n}\nfunction getRepostedEvent(event) {\n  let {\n    skipVerification\n  } = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  const pointer = getRepostedEventPointer(event);\n  if (pointer === void 0 || event.content === \"\") {\n    return void 0;\n  }\n  let repostedEvent;\n  try {\n    repostedEvent = JSON.parse(event.content);\n  } catch (error) {\n    return void 0;\n  }\n  if (repostedEvent.id !== pointer.id) {\n    return void 0;\n  }\n  if (!skipVerification && !verifyEvent(repostedEvent)) {\n    return void 0;\n  }\n  return repostedEvent;\n}\n\n// nip21.ts\nvar nip21_exports = {};\n__export(nip21_exports, {\n  NOSTR_URI_REGEX: () => NOSTR_URI_REGEX,\n  parse: () => parse2,\n  test: () => test\n});\nvar NOSTR_URI_REGEX = new RegExp(\"nostr:(\".concat(BECH32_REGEX.source, \")\"));\nfunction test(value) {\n  return typeof value === \"string\" && new RegExp(\"^\".concat(NOSTR_URI_REGEX.source, \"$\")).test(value);\n}\nfunction parse2(uri) {\n  const match = uri.match(new RegExp(\"^\".concat(NOSTR_URI_REGEX.source, \"$\")));\n  if (!match) throw new Error(\"Invalid Nostr URI: \".concat(uri));\n  return {\n    uri: match[0],\n    value: match[1],\n    decoded: decode(match[1])\n  };\n}\n\n// nip25.ts\nvar nip25_exports = {};\n__export(nip25_exports, {\n  finishReactionEvent: () => finishReactionEvent,\n  getReactedEventPointer: () => getReactedEventPointer\n});\nfunction finishReactionEvent(t, reacted, privateKey) {\n  var _t$tags2, _t$content;\n  const inheritedTags = reacted.tags.filter(tag => tag.length >= 2 && (tag[0] === \"e\" || tag[0] === \"p\"));\n  return finalizeEvent({\n    ...t,\n    kind: Reaction,\n    tags: [...((_t$tags2 = t.tags) !== null && _t$tags2 !== void 0 ? _t$tags2 : []), ...inheritedTags, [\"e\", reacted.id], [\"p\", reacted.pubkey]],\n    content: (_t$content = t.content) !== null && _t$content !== void 0 ? _t$content : \"+\"\n  }, privateKey);\n}\nfunction getReactedEventPointer(event) {\n  if (event.kind !== Reaction) {\n    return void 0;\n  }\n  let lastETag;\n  let lastPTag;\n  for (let i2 = event.tags.length - 1; i2 >= 0 && (lastETag === void 0 || lastPTag === void 0); i2--) {\n    const tag = event.tags[i2];\n    if (tag.length >= 2) {\n      if (tag[0] === \"e\" && lastETag === void 0) {\n        lastETag = tag;\n      } else if (tag[0] === \"p\" && lastPTag === void 0) {\n        lastPTag = tag;\n      }\n    }\n  }\n  if (lastETag === void 0 || lastPTag === void 0) {\n    return void 0;\n  }\n  return {\n    id: lastETag[1],\n    relays: [lastETag[2], lastPTag[2]].filter(x => x !== void 0),\n    author: lastPTag[1]\n  };\n}\n\n// nip27.ts\nvar nip27_exports = {};\n__export(nip27_exports, {\n  matchAll: () => matchAll,\n  regex: () => regex,\n  replaceAll: () => replaceAll\n});\nvar regex = () => new RegExp(\"\\\\b\".concat(NOSTR_URI_REGEX.source, \"\\\\b\"), \"g\");\nfunction* matchAll(content) {\n  const matches = content.matchAll(regex());\n  for (const match of matches) {\n    try {\n      const [uri, value] = match;\n      yield {\n        uri,\n        value,\n        decoded: decode(value),\n        start: match.index,\n        end: match.index + uri.length\n      };\n    } catch (_e) {}\n  }\n}\nfunction replaceAll(content, replacer) {\n  return content.replaceAll(regex(), (uri, value) => {\n    return replacer({\n      uri,\n      value,\n      decoded: decode(value)\n    });\n  });\n}\n\n// nip28.ts\nvar nip28_exports = {};\n__export(nip28_exports, {\n  channelCreateEvent: () => channelCreateEvent,\n  channelHideMessageEvent: () => channelHideMessageEvent,\n  channelMessageEvent: () => channelMessageEvent,\n  channelMetadataEvent: () => channelMetadataEvent,\n  channelMuteUserEvent: () => channelMuteUserEvent\n});\nvar channelCreateEvent = (t, privateKey) => {\n  var _t$tags3;\n  let content;\n  if (typeof t.content === \"object\") {\n    content = JSON.stringify(t.content);\n  } else if (typeof t.content === \"string\") {\n    content = t.content;\n  } else {\n    return void 0;\n  }\n  return finalizeEvent({\n    kind: ChannelCreation,\n    tags: [...((_t$tags3 = t.tags) !== null && _t$tags3 !== void 0 ? _t$tags3 : [])],\n    content,\n    created_at: t.created_at\n  }, privateKey);\n};\nvar channelMetadataEvent = (t, privateKey) => {\n  var _t$tags4;\n  let content;\n  if (typeof t.content === \"object\") {\n    content = JSON.stringify(t.content);\n  } else if (typeof t.content === \"string\") {\n    content = t.content;\n  } else {\n    return void 0;\n  }\n  return finalizeEvent({\n    kind: ChannelMetadata,\n    tags: [[\"e\", t.channel_create_event_id], ...((_t$tags4 = t.tags) !== null && _t$tags4 !== void 0 ? _t$tags4 : [])],\n    content,\n    created_at: t.created_at\n  }, privateKey);\n};\nvar channelMessageEvent = (t, privateKey) => {\n  var _t$tags5;\n  const tags = [[\"e\", t.channel_create_event_id, t.relay_url, \"root\"]];\n  if (t.reply_to_channel_message_event_id) {\n    tags.push([\"e\", t.reply_to_channel_message_event_id, t.relay_url, \"reply\"]);\n  }\n  return finalizeEvent({\n    kind: ChannelMessage,\n    tags: [...tags, ...((_t$tags5 = t.tags) !== null && _t$tags5 !== void 0 ? _t$tags5 : [])],\n    content: t.content,\n    created_at: t.created_at\n  }, privateKey);\n};\nvar channelHideMessageEvent = (t, privateKey) => {\n  var _t$tags6;\n  let content;\n  if (typeof t.content === \"object\") {\n    content = JSON.stringify(t.content);\n  } else if (typeof t.content === \"string\") {\n    content = t.content;\n  } else {\n    return void 0;\n  }\n  return finalizeEvent({\n    kind: ChannelHideMessage,\n    tags: [[\"e\", t.channel_message_event_id], ...((_t$tags6 = t.tags) !== null && _t$tags6 !== void 0 ? _t$tags6 : [])],\n    content,\n    created_at: t.created_at\n  }, privateKey);\n};\nvar channelMuteUserEvent = (t, privateKey) => {\n  var _t$tags7;\n  let content;\n  if (typeof t.content === \"object\") {\n    content = JSON.stringify(t.content);\n  } else if (typeof t.content === \"string\") {\n    content = t.content;\n  } else {\n    return void 0;\n  }\n  return finalizeEvent({\n    kind: ChannelMuteUser,\n    tags: [[\"p\", t.pubkey_to_mute], ...((_t$tags7 = t.tags) !== null && _t$tags7 !== void 0 ? _t$tags7 : [])],\n    content,\n    created_at: t.created_at\n  }, privateKey);\n};\n\n// nip30.ts\nvar nip30_exports = {};\n__export(nip30_exports, {\n  EMOJI_SHORTCODE_REGEX: () => EMOJI_SHORTCODE_REGEX,\n  matchAll: () => matchAll2,\n  regex: () => regex2,\n  replaceAll: () => replaceAll2\n});\nvar EMOJI_SHORTCODE_REGEX = /:(\\w+):/;\nvar regex2 = () => new RegExp(\"\\\\B\".concat(EMOJI_SHORTCODE_REGEX.source, \"\\\\B\"), \"g\");\nfunction* matchAll2(content) {\n  const matches = content.matchAll(regex2());\n  for (const match of matches) {\n    try {\n      const [shortcode, name] = match;\n      yield {\n        shortcode,\n        name,\n        start: match.index,\n        end: match.index + shortcode.length\n      };\n    } catch (_e) {}\n  }\n}\nfunction replaceAll2(content, replacer) {\n  return content.replaceAll(regex2(), (shortcode, name) => {\n    return replacer({\n      shortcode,\n      name\n    });\n  });\n}\n\n// nip39.ts\nvar nip39_exports = {};\n__export(nip39_exports, {\n  useFetchImplementation: () => useFetchImplementation3,\n  validateGithub: () => validateGithub\n});\nvar _fetch3;\ntry {\n  _fetch3 = fetch;\n} catch {}\nfunction useFetchImplementation3(fetchImplementation) {\n  _fetch3 = fetchImplementation;\n}\nasync function validateGithub(pubkey, username, proof) {\n  try {\n    let res = await (await _fetch3(\"https://gist.github.com/\".concat(username, \"/\").concat(proof, \"/raw\"))).text();\n    return res === \"Verifying that I control the following Nostr public key: \".concat(pubkey);\n  } catch (_) {\n    return false;\n  }\n}\n\n// nip44.ts\nvar nip44_exports = {};\n__export(nip44_exports, {\n  default: () => nip44_default,\n  v2: () => v2\n});\nimport { chacha20 } from \"@noble/ciphers/chacha\";\nimport { ensureBytes, equalBytes } from \"@noble/ciphers/utils\";\nimport { secp256k1 as secp256k12 } from \"@noble/curves/secp256k1\";\nimport { extract as hkdf_extract, expand as hkdf_expand } from \"@noble/hashes/hkdf\";\nimport { hmac } from \"@noble/hashes/hmac\";\nimport { sha256 as sha2562 } from \"@noble/hashes/sha256\";\nimport { concatBytes as concatBytes2, randomBytes as randomBytes2, utf8ToBytes } from \"@noble/hashes/utils\";\nimport { base64 as base642 } from \"@scure/base\";\nvar decoder = new TextDecoder();\nvar u = {\n  minPlaintextSize: 1,\n  maxPlaintextSize: 65535,\n  utf8Encode: utf8ToBytes,\n  utf8Decode(bytes) {\n    return decoder.decode(bytes);\n  },\n  getConversationKey(privkeyA, pubkeyB) {\n    const sharedX = secp256k12.getSharedSecret(privkeyA, \"02\" + pubkeyB).subarray(1, 33);\n    return hkdf_extract(sha2562, sharedX, \"nip44-v2\");\n  },\n  getMessageKeys(conversationKey, nonce) {\n    ensureBytes(conversationKey, 32);\n    ensureBytes(nonce, 32);\n    const keys = hkdf_expand(sha2562, conversationKey, nonce, 76);\n    return {\n      chacha_key: keys.subarray(0, 32),\n      chacha_nonce: keys.subarray(32, 44),\n      hmac_key: keys.subarray(44, 76)\n    };\n  },\n  calcPaddedLen(len) {\n    if (!Number.isSafeInteger(len) || len < 1) throw new Error(\"expected positive integer\");\n    if (len <= 32) return 32;\n    const nextPower = 1 << Math.floor(Math.log2(len - 1)) + 1;\n    const chunk = nextPower <= 256 ? 32 : nextPower / 8;\n    return chunk * (Math.floor((len - 1) / chunk) + 1);\n  },\n  writeU16BE(num) {\n    if (!Number.isSafeInteger(num) || num < u.minPlaintextSize || num > u.maxPlaintextSize) throw new Error(\"invalid plaintext size: must be between 1 and 65535 bytes\");\n    const arr = new Uint8Array(2);\n    new DataView(arr.buffer).setUint16(0, num, false);\n    return arr;\n  },\n  pad(plaintext) {\n    const unpadded = u.utf8Encode(plaintext);\n    const unpaddedLen = unpadded.length;\n    const prefix = u.writeU16BE(unpaddedLen);\n    const suffix = new Uint8Array(u.calcPaddedLen(unpaddedLen) - unpaddedLen);\n    return concatBytes2(prefix, unpadded, suffix);\n  },\n  unpad(padded) {\n    const unpaddedLen = new DataView(padded.buffer).getUint16(0);\n    const unpadded = padded.subarray(2, 2 + unpaddedLen);\n    if (unpaddedLen < u.minPlaintextSize || unpaddedLen > u.maxPlaintextSize || unpadded.length !== unpaddedLen || padded.length !== 2 + u.calcPaddedLen(unpaddedLen)) throw new Error(\"invalid padding\");\n    return u.utf8Decode(unpadded);\n  },\n  hmacAad(key, message, aad) {\n    if (aad.length !== 32) throw new Error(\"AAD associated data must be 32 bytes\");\n    const combined = concatBytes2(aad, message);\n    return hmac(sha2562, key, combined);\n  },\n  decodePayload(payload) {\n    if (typeof payload !== \"string\") throw new Error(\"payload must be a valid string\");\n    const plen = payload.length;\n    if (plen < 132 || plen > 87472) throw new Error(\"invalid payload length: \" + plen);\n    if (payload[0] === \"#\") throw new Error(\"unknown encryption version\");\n    let data;\n    try {\n      data = base642.decode(payload);\n    } catch (error) {\n      throw new Error(\"invalid base64: \" + error.message);\n    }\n    const dlen = data.length;\n    if (dlen < 99 || dlen > 65603) throw new Error(\"invalid data length: \" + dlen);\n    const vers = data[0];\n    if (vers !== 2) throw new Error(\"unknown encryption version \" + vers);\n    return {\n      nonce: data.subarray(1, 33),\n      ciphertext: data.subarray(33, -32),\n      mac: data.subarray(-32)\n    };\n  }\n};\nfunction encrypt2(plaintext, conversationKey) {\n  let nonce = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : randomBytes2(32);\n  const {\n    chacha_key,\n    chacha_nonce,\n    hmac_key\n  } = u.getMessageKeys(conversationKey, nonce);\n  const padded = u.pad(plaintext);\n  const ciphertext = chacha20(chacha_key, chacha_nonce, padded);\n  const mac = u.hmacAad(hmac_key, ciphertext, nonce);\n  return base642.encode(concatBytes2(new Uint8Array([2]), nonce, ciphertext, mac));\n}\nfunction decrypt2(payload, conversationKey) {\n  const {\n    nonce,\n    ciphertext,\n    mac\n  } = u.decodePayload(payload);\n  const {\n    chacha_key,\n    chacha_nonce,\n    hmac_key\n  } = u.getMessageKeys(conversationKey, nonce);\n  const calculatedMac = u.hmacAad(hmac_key, ciphertext, nonce);\n  if (!equalBytes(calculatedMac, mac)) throw new Error(\"invalid MAC\");\n  const padded = chacha20(chacha_key, chacha_nonce, ciphertext);\n  return u.unpad(padded);\n}\nvar v2 = {\n  utils: u,\n  encrypt: encrypt2,\n  decrypt: decrypt2\n};\nvar nip44_default = {\n  v2\n};\n\n// nip47.ts\nvar nip47_exports = {};\n__export(nip47_exports, {\n  makeNwcRequestEvent: () => makeNwcRequestEvent,\n  parseConnectionString: () => parseConnectionString\n});\nfunction parseConnectionString(connectionString) {\n  const {\n    pathname,\n    searchParams\n  } = new URL(connectionString);\n  const pubkey = pathname;\n  const relay = searchParams.get(\"relay\");\n  const secret = searchParams.get(\"secret\");\n  if (!pubkey || !relay || !secret) {\n    throw new Error(\"invalid connection string\");\n  }\n  return {\n    pubkey,\n    relay,\n    secret\n  };\n}\nasync function makeNwcRequestEvent(pubkey, secretKey, invoice) {\n  const content = {\n    method: \"pay_invoice\",\n    params: {\n      invoice\n    }\n  };\n  const encryptedContent = await encrypt(secretKey, pubkey, JSON.stringify(content));\n  const eventTemplate = {\n    kind: NWCWalletRequest,\n    created_at: Math.round(Date.now() / 1e3),\n    content: encryptedContent,\n    tags: [[\"p\", pubkey]]\n  };\n  return finalizeEvent(eventTemplate, secretKey);\n}\n\n// nip57.ts\nvar nip57_exports = {};\n__export(nip57_exports, {\n  getZapEndpoint: () => getZapEndpoint,\n  makeZapReceipt: () => makeZapReceipt,\n  makeZapRequest: () => makeZapRequest,\n  useFetchImplementation: () => useFetchImplementation4,\n  validateZapRequest: () => validateZapRequest\n});\nimport { bech32 as bech322 } from \"@scure/base\";\nvar _fetch4;\ntry {\n  _fetch4 = fetch;\n} catch {}\nfunction useFetchImplementation4(fetchImplementation) {\n  _fetch4 = fetchImplementation;\n}\nasync function getZapEndpoint(metadata) {\n  try {\n    let lnurl = \"\";\n    let {\n      lud06,\n      lud16\n    } = JSON.parse(metadata.content);\n    if (lud06) {\n      let {\n        words\n      } = bech322.decode(lud06, 1e3);\n      let data = bech322.fromWords(words);\n      lnurl = utf8Decoder.decode(data);\n    } else if (lud16) {\n      let [name, domain] = lud16.split(\"@\");\n      lnurl = new URL(\"/.well-known/lnurlp/\".concat(name), \"https://\".concat(domain)).toString();\n    } else {\n      return null;\n    }\n    let res = await _fetch4(lnurl);\n    let body = await res.json();\n    if (body.allowsNostr && body.nostrPubkey) {\n      return body.callback;\n    }\n  } catch (err) {}\n  return null;\n}\nfunction makeZapRequest(_ref4) {\n  let {\n    profile,\n    event,\n    amount,\n    relays,\n    comment = \"\"\n  } = _ref4;\n  if (!amount) throw new Error(\"amount not given\");\n  if (!profile) throw new Error(\"profile not given\");\n  let zr = {\n    kind: 9734,\n    created_at: Math.round(Date.now() / 1e3),\n    content: comment,\n    tags: [[\"p\", profile], [\"amount\", amount.toString()], [\"relays\", ...relays]]\n  };\n  if (event) {\n    zr.tags.push([\"e\", event]);\n  }\n  return zr;\n}\nfunction validateZapRequest(zapRequestString) {\n  let zapRequest;\n  try {\n    zapRequest = JSON.parse(zapRequestString);\n  } catch (err) {\n    return \"Invalid zap request JSON.\";\n  }\n  if (!validateEvent(zapRequest)) return \"Zap request is not a valid Nostr event.\";\n  if (!verifyEvent(zapRequest)) return \"Invalid signature on zap request.\";\n  let p = zapRequest.tags.find(_ref5 => {\n    let [t, v] = _ref5;\n    return t === \"p\" && v;\n  });\n  if (!p) return \"Zap request doesn't have a 'p' tag.\";\n  if (!p[1].match(/^[a-f0-9]{64}$/)) return \"Zap request 'p' tag is not valid hex.\";\n  let e = zapRequest.tags.find(_ref6 => {\n    let [t, v] = _ref6;\n    return t === \"e\" && v;\n  });\n  if (e && !e[1].match(/^[a-f0-9]{64}$/)) return \"Zap request 'e' tag is not valid hex.\";\n  let relays = zapRequest.tags.find(_ref7 => {\n    let [t, v] = _ref7;\n    return t === \"relays\" && v;\n  });\n  if (!relays) return \"Zap request doesn't have a 'relays' tag.\";\n  return null;\n}\nfunction makeZapReceipt(_ref8) {\n  let {\n    zapRequest,\n    preimage,\n    bolt11,\n    paidAt\n  } = _ref8;\n  let zr = JSON.parse(zapRequest);\n  let tagsFromZapRequest = zr.tags.filter(_ref9 => {\n    let [t] = _ref9;\n    return t === \"e\" || t === \"p\" || t === \"a\";\n  });\n  let zap = {\n    kind: 9735,\n    created_at: Math.round(paidAt.getTime() / 1e3),\n    content: \"\",\n    tags: [...tagsFromZapRequest, [\"P\", zr.pubkey], [\"bolt11\", bolt11], [\"description\", zapRequest]]\n  };\n  if (preimage) {\n    zap.tags.push([\"preimage\", preimage]);\n  }\n  return zap;\n}\n\n// nip98.ts\nvar nip98_exports = {};\n__export(nip98_exports, {\n  getToken: () => getToken,\n  hashPayload: () => hashPayload,\n  unpackEventFromToken: () => unpackEventFromToken,\n  validateEvent: () => validateEvent2,\n  validateEventKind: () => validateEventKind,\n  validateEventMethodTag: () => validateEventMethodTag,\n  validateEventPayloadTag: () => validateEventPayloadTag,\n  validateEventTimestamp: () => validateEventTimestamp,\n  validateEventUrlTag: () => validateEventUrlTag,\n  validateToken: () => validateToken\n});\nimport { sha256 as sha2563 } from \"@noble/hashes/sha256\";\nimport { bytesToHex as bytesToHex4 } from \"@noble/hashes/utils\";\nimport { base64 as base643 } from \"@scure/base\";\nvar _authorizationScheme = \"Nostr \";\nasync function getToken(loginUrl, httpMethod, sign) {\n  let includeAuthorizationScheme = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n  let payload = arguments.length > 4 ? arguments[4] : undefined;\n  const event = {\n    kind: HTTPAuth,\n    tags: [[\"u\", loginUrl], [\"method\", httpMethod]],\n    created_at: Math.round(new Date().getTime() / 1e3),\n    content: \"\"\n  };\n  if (payload) {\n    event.tags.push([\"payload\", hashPayload(payload)]);\n  }\n  const signedEvent = await sign(event);\n  const authorizationScheme = includeAuthorizationScheme ? _authorizationScheme : \"\";\n  return authorizationScheme + base643.encode(utf8Encoder.encode(JSON.stringify(signedEvent)));\n}\nasync function validateToken(token, url, method) {\n  const event = await unpackEventFromToken(token).catch(error => {\n    throw error;\n  });\n  const valid = await validateEvent2(event, url, method).catch(error => {\n    throw error;\n  });\n  return valid;\n}\nasync function unpackEventFromToken(token) {\n  if (!token) {\n    throw new Error(\"Missing token\");\n  }\n  token = token.replace(_authorizationScheme, \"\");\n  const eventB64 = utf8Decoder.decode(base643.decode(token));\n  if (!eventB64 || eventB64.length === 0 || !eventB64.startsWith(\"{\")) {\n    throw new Error(\"Invalid token\");\n  }\n  const event = JSON.parse(eventB64);\n  return event;\n}\nfunction validateEventTimestamp(event) {\n  if (!event.created_at) {\n    return false;\n  }\n  return Math.round(new Date().getTime() / 1e3) - event.created_at < 60;\n}\nfunction validateEventKind(event) {\n  return event.kind === HTTPAuth;\n}\nfunction validateEventUrlTag(event, url) {\n  const urlTag = event.tags.find(t => t[0] === \"u\");\n  if (!urlTag) {\n    return false;\n  }\n  return urlTag.length > 0 && urlTag[1] === url;\n}\nfunction validateEventMethodTag(event, method) {\n  const methodTag = event.tags.find(t => t[0] === \"method\");\n  if (!methodTag) {\n    return false;\n  }\n  return methodTag.length > 0 && methodTag[1].toLowerCase() === method.toLowerCase();\n}\nfunction hashPayload(payload) {\n  const hash = sha2563(utf8Encoder.encode(JSON.stringify(payload)));\n  return bytesToHex4(hash);\n}\nfunction validateEventPayloadTag(event, payload) {\n  const payloadTag = event.tags.find(t => t[0] === \"payload\");\n  if (!payloadTag) {\n    return false;\n  }\n  const payloadHash = hashPayload(payload);\n  return payloadTag.length > 0 && payloadTag[1] === payloadHash;\n}\nasync function validateEvent2(event, url, method, body) {\n  if (!verifyEvent(event)) {\n    throw new Error(\"Invalid nostr event, signature invalid\");\n  }\n  if (!validateEventKind(event)) {\n    throw new Error(\"Invalid nostr event, kind invalid\");\n  }\n  if (!validateEventTimestamp(event)) {\n    throw new Error(\"Invalid nostr event, created_at timestamp invalid\");\n  }\n  if (!validateEventUrlTag(event, url)) {\n    throw new Error(\"Invalid nostr event, url tag invalid\");\n  }\n  if (!validateEventMethodTag(event, method)) {\n    throw new Error(\"Invalid nostr event, method tag invalid\");\n  }\n  if (Boolean(body) && typeof body === \"object\" && Object.keys(body).length > 0) {\n    if (!validateEventPayloadTag(event, body)) {\n      throw new Error(\"Invalid nostr event, payload tag does not match request body hash\");\n    }\n  }\n  return true;\n}\nexport { AbstractRelay, AbstractSimplePool, Relay, SimplePool, Subscription, finalizeEvent, fakejson_exports as fj, generateSecretKey, getEventHash, getFilterLimit, getPublicKey, kinds_exports as kinds, matchFilter, matchFilters, mergeFilters, nip04_exports as nip04, nip05_exports as nip05, nip10_exports as nip10, nip11_exports as nip11, nip13_exports as nip13, nip18_exports as nip18, nip19_exports as nip19, nip21_exports as nip21, nip25_exports as nip25, nip27_exports as nip27, nip28_exports as nip28, nip30_exports as nip30, nip39_exports as nip39, nip42_exports as nip42, nip44_exports as nip44, nip47_exports as nip47, nip57_exports as nip57, nip98_exports as nip98, parseReferences, relayConnect, serializeEvent, utils_exports as utils, validateEvent, verifiedSymbol, verifyEvent };","map":{"version":3,"names":["__defProp","Object","defineProperty","__export","target","all","name","get","enumerable","schnorr","bytesToHex","verifiedSymbol","Symbol","isRecord","obj","validateEvent","event","kind","content","created_at","pubkey","match","Array","isArray","tags","i2","length","tag","j","sha256","utils_exports","Queue","QueueNode","binarySearch","insertEventIntoAscendingList","insertEventIntoDescendingList","normalizeURL","utf8Decoder","utf8Encoder","TextDecoder","TextEncoder","url","indexOf","p","URL","pathname","replace","endsWith","slice","port","protocol","searchParams","sort","hash","toString","sortedArray","idx","found","b","id","splice","arr","compare","start","end","mid","Math","floor","cmp","constructor","message","_defineProperty","value","first","last","enqueue","newNode","prev","next","dequeue","target2","JS","generateSecretKey","utils","randomPrivateKey","getPublicKey","secretKey","finalizeEvent","t","getEventHash","sig","sign","verifyEvent","valid","verify","err","serializeEvent","evt","Error","JSON","stringify","eventHash","encode","i","kinds_exports","Application","BadgeAward","BadgeDefinition","BlockedRelaysList","BookmarkList","Bookmarksets","Calendar","CalendarEventRSVP","ChannelCreation","ChannelHideMessage","ChannelMessage","ChannelMetadata","ChannelMuteUser","ClassifiedListing","ClientAuth","CommunitiesList","CommunityDefinition","CommunityPostApproval","Contacts","CreateOrUpdateProduct","CreateOrUpdateStall","Curationsets","Date","Date2","DraftClassifiedListing","DraftLong","Emojisets","EncryptedDirectMessage","EncryptedDirectMessages","EventDeletion","FileMetadata","FileServerPreference","Followsets","GenericRepost","Genericlists","HTTPAuth","Handlerinformation","Handlerrecommendation","Highlights","InterestsList","Interestsets","JobFeedback","JobRequest","JobResult","Label","LightningPubRPC","LiveChatMessage","LiveEvent","LongFormArticle","Metadata","Mutelist","NWCWalletInfo","NWCWalletRequest","NWCWalletResponse","NostrConnect","OpenTimestamps","Pinlist","ProblemTracker","ProfileBadges","PublicChatsList","Reaction","RecommendRelay","RelayList","Relaysets","Report","Reporting","Repost","SearchRelaysList","ShortTextNote","Time","UserEmojiList","UserStatuses","Zap","ZapGoal","ZapRequest","classifyKind","isEphemeralKind","isParameterizedReplaceableKind","isRegularKind","isReplaceableKind","includes","matchFilter","filter","ids","some","prefix","startsWith","kinds","authors","f","tagName","values","concat","find","_ref","v","since","until","matchFilters","filters","mergeFilters","result","arguments","undefined","entries","forEach","_ref2","property","push","limit","getFilterLimit","_filter$limit","_filter$ids$length","_filter$ids","_filter$authors","_filter$kinds","min","max","Infinity","every","fakejson_exports","getHex64","getInt","getSubscriptionId","matchEventId","matchEventKind","matchEventPubkey","json","field","len","s","sliced","parseInt","pstart","pend","nip42_exports","makeAuthEvent","relayURL","challenge","now","yieldThread","Promise","resolve","ch","MessageChannel","handler","port1","removeEventListener","addEventListener","port2","postMessage","alwaysTrue","AbstractRelay","opts","msg","console","debug","Map","connect","relay","closeAllSubscriptions","reason","_","sub","openSubs","close","clear","ep","openEventPublishes","reject","cr","openCountRequests","connected","_connected","connectionPromise","connectionTimeoutHandle","setTimeout","_this$onclose","onclose","call","connectionTimeout","ws","WebSocket","onopen","clearTimeout","onerror","ev","_this$onclose2","_this$onclose3","onmessage","_onmessage","bind","runQueue","queueRunning","handleNext","incomingMessageQueue","subid","_so$alreadyHaveEvent","_so$receivedEvent","so","alreadyHave","alreadyHaveEvent","receivedEvent","data","parse","onevent","payload","count","delete","receivedEose","ok","closed","onnotice","send","then","_this$ws","auth","signAuthEvent","ret","set","publish","params","serial","subscribe","subscription","prepareSubscription","fire","Subscription","_this$ws2","eoseTimeout","baseEoseTimeout","oneose","warn","substring","eoseTimeoutHandle","_this$oneose","eosed","_this$onclose4","relayConnect","Relay","AbstractSimplePool","Set","ensureRelay","relays","trustedRelayURLs","has","map","_this$relays$get","subscribeMany","trackRelays","seenOn","add","_knownIds","subs","eosesReceived","handleEose","a","_params$oneose","closesReceived","handleClose","_params$onclose","localAlreadyHaveEventHandler","_params$alreadyHaveEv","have","allOpened","maxWait","String","subscribeManyEose","subcloser","querySync","events","r","SimplePool","nip19_exports","BECH32_REGEX","decode","naddrEncode","neventEncode","noteEncode","nprofileEncode","npubEncode","nrelayEncode","nsecEncode","bytesToHex2","concatBytes","hexToBytes","bech32","Bech32MaxSize","integerToUint8Array","number","uint8Array","Uint8Array","nip19","words","fromWords","_tlv$","tlv","parseTLV","type","d","_tlv$2","_tlv$3","_tlv$4","author","_tlv$5","_tlv$6","_tlv$7","identifier","_tlv$8","rest","l","key","encodeBytes","hex","encodeBech32","toWords","bytes","profile","encodeTLV","kindArray","addr","ArrayBuffer","DataView","setUint32","reverse","_ref3","vs","entry","mentionRegex","parseReferences","references","ref","matchAll","text","address","split","nip04_exports","decrypt","encrypt","bytesToHex3","randomBytes","secp256k1","base64","crypto","subtle","webcrypto","privkey","getSharedSecret","normalizedKey","getNormalizedX","iv","from","plaintext","cryptoKey","importKey","ciphertext","ctb64","ivb64","buffer","nip05_exports","NIP05_REGEX","queryProfile","searchDomain","useFetchImplementation","_fetch","fetch","fetchImplementation","domain","query","res","names","fullname","parseNIP05Result","_e","nip10_exports","reply","root","mentions","profiles","eTags","eTagIndex","eTag","eTagEventId","eTagRelayUrl","eTagMarker","eventPointer","isFirstETag","isLastETag","nip11_exports","fetchRelayInformation","useFetchImplementation2","_fetch2","headers","Accept","nip13_exports","getPow","minePow","nibble","clz32","unsigned","difficulty","getTime","nip18_exports","finishRepostEvent","getRepostedEvent","getRepostedEventPointer","reposted","relayUrl","privateKey","_t$tags","_lastPTag","_lastPTag2","lastETag","lastPTag","x","skipVerification","pointer","repostedEvent","error","nip21_exports","NOSTR_URI_REGEX","parse2","test","RegExp","source","uri","decoded","nip25_exports","finishReactionEvent","getReactedEventPointer","reacted","_t$tags2","_t$content","inheritedTags","nip27_exports","regex","replaceAll","matches","index","replacer","nip28_exports","channelCreateEvent","channelHideMessageEvent","channelMessageEvent","channelMetadataEvent","channelMuteUserEvent","_t$tags3","_t$tags4","channel_create_event_id","_t$tags5","relay_url","reply_to_channel_message_event_id","_t$tags6","channel_message_event_id","_t$tags7","pubkey_to_mute","nip30_exports","EMOJI_SHORTCODE_REGEX","matchAll2","regex2","replaceAll2","shortcode","nip39_exports","useFetchImplementation3","validateGithub","_fetch3","username","proof","nip44_exports","default","nip44_default","v2","chacha20","ensureBytes","equalBytes","secp256k12","extract","hkdf_extract","expand","hkdf_expand","hmac","sha2562","concatBytes2","randomBytes2","utf8ToBytes","base642","decoder","u","minPlaintextSize","maxPlaintextSize","utf8Encode","utf8Decode","getConversationKey","privkeyA","pubkeyB","sharedX","subarray","getMessageKeys","conversationKey","nonce","keys","chacha_key","chacha_nonce","hmac_key","calcPaddedLen","Number","isSafeInteger","nextPower","log2","chunk","writeU16BE","num","setUint16","pad","unpadded","unpaddedLen","suffix","unpad","padded","getUint16","hmacAad","aad","combined","decodePayload","plen","dlen","vers","mac","encrypt2","decrypt2","calculatedMac","nip47_exports","makeNwcRequestEvent","parseConnectionString","connectionString","secret","invoice","method","encryptedContent","eventTemplate","round","nip57_exports","getZapEndpoint","makeZapReceipt","makeZapRequest","useFetchImplementation4","validateZapRequest","bech322","_fetch4","metadata","lnurl","lud06","lud16","body","allowsNostr","nostrPubkey","callback","_ref4","amount","comment","zr","zapRequestString","zapRequest","_ref5","e","_ref6","_ref7","_ref8","preimage","bolt11","paidAt","tagsFromZapRequest","_ref9","zap","nip98_exports","getToken","hashPayload","unpackEventFromToken","validateEvent2","validateEventKind","validateEventMethodTag","validateEventPayloadTag","validateEventTimestamp","validateEventUrlTag","validateToken","sha2563","bytesToHex4","base643","_authorizationScheme","loginUrl","httpMethod","includeAuthorizationScheme","signedEvent","authorizationScheme","token","catch","eventB64","urlTag","methodTag","toLowerCase","payloadTag","payloadHash","Boolean","fj","nip04","nip05","nip10","nip11","nip13","nip18","nip21","nip25","nip27","nip28","nip30","nip39","nip42","nip44","nip47","nip57","nip98"],"sources":["/Users/lance/myProject/nostr-client-web/node_modules/nostr-tools/lib/esm/index.js"],"sourcesContent":["var __defProp = Object.defineProperty;\nvar __export = (target, all) => {\n  for (var name in all)\n    __defProp(target, name, { get: all[name], enumerable: true });\n};\n\n// pure.ts\nimport { schnorr } from \"@noble/curves/secp256k1\";\nimport { bytesToHex } from \"@noble/hashes/utils\";\n\n// core.ts\nvar verifiedSymbol = Symbol(\"verified\");\nvar isRecord = (obj) => obj instanceof Object;\nfunction validateEvent(event) {\n  if (!isRecord(event))\n    return false;\n  if (typeof event.kind !== \"number\")\n    return false;\n  if (typeof event.content !== \"string\")\n    return false;\n  if (typeof event.created_at !== \"number\")\n    return false;\n  if (typeof event.pubkey !== \"string\")\n    return false;\n  if (!event.pubkey.match(/^[a-f0-9]{64}$/))\n    return false;\n  if (!Array.isArray(event.tags))\n    return false;\n  for (let i2 = 0; i2 < event.tags.length; i2++) {\n    let tag = event.tags[i2];\n    if (!Array.isArray(tag))\n      return false;\n    for (let j = 0; j < tag.length; j++) {\n      if (typeof tag[j] === \"object\")\n        return false;\n    }\n  }\n  return true;\n}\n\n// pure.ts\nimport { sha256 } from \"@noble/hashes/sha256\";\n\n// utils.ts\nvar utils_exports = {};\n__export(utils_exports, {\n  Queue: () => Queue,\n  QueueNode: () => QueueNode,\n  binarySearch: () => binarySearch,\n  insertEventIntoAscendingList: () => insertEventIntoAscendingList,\n  insertEventIntoDescendingList: () => insertEventIntoDescendingList,\n  normalizeURL: () => normalizeURL,\n  utf8Decoder: () => utf8Decoder,\n  utf8Encoder: () => utf8Encoder\n});\nvar utf8Decoder = new TextDecoder(\"utf-8\");\nvar utf8Encoder = new TextEncoder();\nfunction normalizeURL(url) {\n  if (url.indexOf(\"://\") === -1)\n    url = \"wss://\" + url;\n  let p = new URL(url);\n  p.pathname = p.pathname.replace(/\\/+/g, \"/\");\n  if (p.pathname.endsWith(\"/\"))\n    p.pathname = p.pathname.slice(0, -1);\n  if (p.port === \"80\" && p.protocol === \"ws:\" || p.port === \"443\" && p.protocol === \"wss:\")\n    p.port = \"\";\n  p.searchParams.sort();\n  p.hash = \"\";\n  return p.toString();\n}\nfunction insertEventIntoDescendingList(sortedArray, event) {\n  const [idx, found] = binarySearch(sortedArray, (b) => {\n    if (event.id === b.id)\n      return 0;\n    if (event.created_at === b.created_at)\n      return -1;\n    return b.created_at - event.created_at;\n  });\n  if (!found) {\n    sortedArray.splice(idx, 0, event);\n  }\n  return sortedArray;\n}\nfunction insertEventIntoAscendingList(sortedArray, event) {\n  const [idx, found] = binarySearch(sortedArray, (b) => {\n    if (event.id === b.id)\n      return 0;\n    if (event.created_at === b.created_at)\n      return -1;\n    return event.created_at - b.created_at;\n  });\n  if (!found) {\n    sortedArray.splice(idx, 0, event);\n  }\n  return sortedArray;\n}\nfunction binarySearch(arr, compare) {\n  let start = 0;\n  let end = arr.length - 1;\n  while (start <= end) {\n    const mid = Math.floor((start + end) / 2);\n    const cmp = compare(arr[mid]);\n    if (cmp === 0) {\n      return [mid, true];\n    }\n    if (cmp < 0) {\n      end = mid - 1;\n    } else {\n      start = mid + 1;\n    }\n  }\n  return [start, false];\n}\nvar QueueNode = class {\n  value;\n  next = null;\n  prev = null;\n  constructor(message) {\n    this.value = message;\n  }\n};\nvar Queue = class {\n  first;\n  last;\n  constructor() {\n    this.first = null;\n    this.last = null;\n  }\n  enqueue(value) {\n    const newNode = new QueueNode(value);\n    if (!this.last) {\n      this.first = newNode;\n      this.last = newNode;\n    } else if (this.last === this.first) {\n      this.last = newNode;\n      this.last.prev = this.first;\n      this.first.next = newNode;\n    } else {\n      newNode.prev = this.last;\n      this.last.next = newNode;\n      this.last = newNode;\n    }\n    return true;\n  }\n  dequeue() {\n    if (!this.first)\n      return null;\n    if (this.first === this.last) {\n      const target2 = this.first;\n      this.first = null;\n      this.last = null;\n      return target2.value;\n    }\n    const target = this.first;\n    this.first = target.next;\n    return target.value;\n  }\n};\n\n// pure.ts\nvar JS = class {\n  generateSecretKey() {\n    return schnorr.utils.randomPrivateKey();\n  }\n  getPublicKey(secretKey) {\n    return bytesToHex(schnorr.getPublicKey(secretKey));\n  }\n  finalizeEvent(t, secretKey) {\n    const event = t;\n    event.pubkey = bytesToHex(schnorr.getPublicKey(secretKey));\n    event.id = getEventHash(event);\n    event.sig = bytesToHex(schnorr.sign(getEventHash(event), secretKey));\n    event[verifiedSymbol] = true;\n    return event;\n  }\n  verifyEvent(event) {\n    if (typeof event[verifiedSymbol] === \"boolean\")\n      return event[verifiedSymbol];\n    const hash = getEventHash(event);\n    if (hash !== event.id) {\n      event[verifiedSymbol] = false;\n      return false;\n    }\n    try {\n      const valid = schnorr.verify(event.sig, hash, event.pubkey);\n      event[verifiedSymbol] = valid;\n      return valid;\n    } catch (err) {\n      event[verifiedSymbol] = false;\n      return false;\n    }\n  }\n};\nfunction serializeEvent(evt) {\n  if (!validateEvent(evt))\n    throw new Error(\"can't serialize event with wrong or missing properties\");\n  return JSON.stringify([0, evt.pubkey, evt.created_at, evt.kind, evt.tags, evt.content]);\n}\nfunction getEventHash(event) {\n  let eventHash = sha256(utf8Encoder.encode(serializeEvent(event)));\n  return bytesToHex(eventHash);\n}\nvar i = new JS();\nvar generateSecretKey = i.generateSecretKey;\nvar getPublicKey = i.getPublicKey;\nvar finalizeEvent = i.finalizeEvent;\nvar verifyEvent = i.verifyEvent;\n\n// kinds.ts\nvar kinds_exports = {};\n__export(kinds_exports, {\n  Application: () => Application,\n  BadgeAward: () => BadgeAward,\n  BadgeDefinition: () => BadgeDefinition,\n  BlockedRelaysList: () => BlockedRelaysList,\n  BookmarkList: () => BookmarkList,\n  Bookmarksets: () => Bookmarksets,\n  Calendar: () => Calendar,\n  CalendarEventRSVP: () => CalendarEventRSVP,\n  ChannelCreation: () => ChannelCreation,\n  ChannelHideMessage: () => ChannelHideMessage,\n  ChannelMessage: () => ChannelMessage,\n  ChannelMetadata: () => ChannelMetadata,\n  ChannelMuteUser: () => ChannelMuteUser,\n  ClassifiedListing: () => ClassifiedListing,\n  ClientAuth: () => ClientAuth,\n  CommunitiesList: () => CommunitiesList,\n  CommunityDefinition: () => CommunityDefinition,\n  CommunityPostApproval: () => CommunityPostApproval,\n  Contacts: () => Contacts,\n  CreateOrUpdateProduct: () => CreateOrUpdateProduct,\n  CreateOrUpdateStall: () => CreateOrUpdateStall,\n  Curationsets: () => Curationsets,\n  Date: () => Date2,\n  DraftClassifiedListing: () => DraftClassifiedListing,\n  DraftLong: () => DraftLong,\n  Emojisets: () => Emojisets,\n  EncryptedDirectMessage: () => EncryptedDirectMessage,\n  EncryptedDirectMessages: () => EncryptedDirectMessages,\n  EventDeletion: () => EventDeletion,\n  FileMetadata: () => FileMetadata,\n  FileServerPreference: () => FileServerPreference,\n  Followsets: () => Followsets,\n  GenericRepost: () => GenericRepost,\n  Genericlists: () => Genericlists,\n  HTTPAuth: () => HTTPAuth,\n  Handlerinformation: () => Handlerinformation,\n  Handlerrecommendation: () => Handlerrecommendation,\n  Highlights: () => Highlights,\n  InterestsList: () => InterestsList,\n  Interestsets: () => Interestsets,\n  JobFeedback: () => JobFeedback,\n  JobRequest: () => JobRequest,\n  JobResult: () => JobResult,\n  Label: () => Label,\n  LightningPubRPC: () => LightningPubRPC,\n  LiveChatMessage: () => LiveChatMessage,\n  LiveEvent: () => LiveEvent,\n  LongFormArticle: () => LongFormArticle,\n  Metadata: () => Metadata,\n  Mutelist: () => Mutelist,\n  NWCWalletInfo: () => NWCWalletInfo,\n  NWCWalletRequest: () => NWCWalletRequest,\n  NWCWalletResponse: () => NWCWalletResponse,\n  NostrConnect: () => NostrConnect,\n  OpenTimestamps: () => OpenTimestamps,\n  Pinlist: () => Pinlist,\n  ProblemTracker: () => ProblemTracker,\n  ProfileBadges: () => ProfileBadges,\n  PublicChatsList: () => PublicChatsList,\n  Reaction: () => Reaction,\n  RecommendRelay: () => RecommendRelay,\n  RelayList: () => RelayList,\n  Relaysets: () => Relaysets,\n  Report: () => Report,\n  Reporting: () => Reporting,\n  Repost: () => Repost,\n  SearchRelaysList: () => SearchRelaysList,\n  ShortTextNote: () => ShortTextNote,\n  Time: () => Time,\n  UserEmojiList: () => UserEmojiList,\n  UserStatuses: () => UserStatuses,\n  Zap: () => Zap,\n  ZapGoal: () => ZapGoal,\n  ZapRequest: () => ZapRequest,\n  classifyKind: () => classifyKind,\n  isEphemeralKind: () => isEphemeralKind,\n  isParameterizedReplaceableKind: () => isParameterizedReplaceableKind,\n  isRegularKind: () => isRegularKind,\n  isReplaceableKind: () => isReplaceableKind\n});\nfunction isRegularKind(kind) {\n  return 1e3 <= kind && kind < 1e4 || [1, 2, 4, 5, 6, 7, 8, 16, 40, 41, 42, 43, 44].includes(kind);\n}\nfunction isReplaceableKind(kind) {\n  return [0, 3].includes(kind) || 1e4 <= kind && kind < 2e4;\n}\nfunction isEphemeralKind(kind) {\n  return 2e4 <= kind && kind < 3e4;\n}\nfunction isParameterizedReplaceableKind(kind) {\n  return 3e4 <= kind && kind < 4e4;\n}\nfunction classifyKind(kind) {\n  if (isRegularKind(kind))\n    return \"regular\";\n  if (isReplaceableKind(kind))\n    return \"replaceable\";\n  if (isEphemeralKind(kind))\n    return \"ephemeral\";\n  if (isParameterizedReplaceableKind(kind))\n    return \"parameterized\";\n  return \"unknown\";\n}\nvar Metadata = 0;\nvar ShortTextNote = 1;\nvar RecommendRelay = 2;\nvar Contacts = 3;\nvar EncryptedDirectMessage = 4;\nvar EncryptedDirectMessages = 4;\nvar EventDeletion = 5;\nvar Repost = 6;\nvar Reaction = 7;\nvar BadgeAward = 8;\nvar GenericRepost = 16;\nvar ChannelCreation = 40;\nvar ChannelMetadata = 41;\nvar ChannelMessage = 42;\nvar ChannelHideMessage = 43;\nvar ChannelMuteUser = 44;\nvar OpenTimestamps = 1040;\nvar FileMetadata = 1063;\nvar LiveChatMessage = 1311;\nvar ProblemTracker = 1971;\nvar Report = 1984;\nvar Reporting = 1984;\nvar Label = 1985;\nvar CommunityPostApproval = 4550;\nvar JobRequest = 5999;\nvar JobResult = 6999;\nvar JobFeedback = 7e3;\nvar ZapGoal = 9041;\nvar ZapRequest = 9734;\nvar Zap = 9735;\nvar Highlights = 9802;\nvar Mutelist = 1e4;\nvar Pinlist = 10001;\nvar RelayList = 10002;\nvar BookmarkList = 10003;\nvar CommunitiesList = 10004;\nvar PublicChatsList = 10005;\nvar BlockedRelaysList = 10006;\nvar SearchRelaysList = 10007;\nvar InterestsList = 10015;\nvar UserEmojiList = 10030;\nvar FileServerPreference = 10096;\nvar NWCWalletInfo = 13194;\nvar LightningPubRPC = 21e3;\nvar ClientAuth = 22242;\nvar NWCWalletRequest = 23194;\nvar NWCWalletResponse = 23195;\nvar NostrConnect = 24133;\nvar HTTPAuth = 27235;\nvar Followsets = 3e4;\nvar Genericlists = 30001;\nvar Relaysets = 30002;\nvar Bookmarksets = 30003;\nvar Curationsets = 30004;\nvar ProfileBadges = 30008;\nvar BadgeDefinition = 30009;\nvar Interestsets = 30015;\nvar CreateOrUpdateStall = 30017;\nvar CreateOrUpdateProduct = 30018;\nvar LongFormArticle = 30023;\nvar DraftLong = 30024;\nvar Emojisets = 30030;\nvar Application = 30078;\nvar LiveEvent = 30311;\nvar UserStatuses = 30315;\nvar ClassifiedListing = 30402;\nvar DraftClassifiedListing = 30403;\nvar Date2 = 31922;\nvar Time = 31923;\nvar Calendar = 31924;\nvar CalendarEventRSVP = 31925;\nvar Handlerrecommendation = 31989;\nvar Handlerinformation = 31990;\nvar CommunityDefinition = 34550;\n\n// filter.ts\nfunction matchFilter(filter, event) {\n  if (filter.ids && filter.ids.indexOf(event.id) === -1) {\n    if (!filter.ids.some((prefix) => event.id.startsWith(prefix))) {\n      return false;\n    }\n  }\n  if (filter.kinds && filter.kinds.indexOf(event.kind) === -1)\n    return false;\n  if (filter.authors && filter.authors.indexOf(event.pubkey) === -1) {\n    if (!filter.authors.some((prefix) => event.pubkey.startsWith(prefix))) {\n      return false;\n    }\n  }\n  for (let f in filter) {\n    if (f[0] === \"#\") {\n      let tagName = f.slice(1);\n      let values = filter[`#${tagName}`];\n      if (values && !event.tags.find(([t, v]) => t === f.slice(1) && values.indexOf(v) !== -1))\n        return false;\n    }\n  }\n  if (filter.since && event.created_at < filter.since)\n    return false;\n  if (filter.until && event.created_at > filter.until)\n    return false;\n  return true;\n}\nfunction matchFilters(filters, event) {\n  for (let i2 = 0; i2 < filters.length; i2++) {\n    if (matchFilter(filters[i2], event))\n      return true;\n  }\n  return false;\n}\nfunction mergeFilters(...filters) {\n  let result = {};\n  for (let i2 = 0; i2 < filters.length; i2++) {\n    let filter = filters[i2];\n    Object.entries(filter).forEach(([property, values]) => {\n      if (property === \"kinds\" || property === \"ids\" || property === \"authors\" || property[0] === \"#\") {\n        result[property] = result[property] || [];\n        for (let v = 0; v < values.length; v++) {\n          let value = values[v];\n          if (!result[property].includes(value))\n            result[property].push(value);\n        }\n      }\n    });\n    if (filter.limit && (!result.limit || filter.limit > result.limit))\n      result.limit = filter.limit;\n    if (filter.until && (!result.until || filter.until > result.until))\n      result.until = filter.until;\n    if (filter.since && (!result.since || filter.since < result.since))\n      result.since = filter.since;\n  }\n  return result;\n}\nfunction getFilterLimit(filter) {\n  if (filter.ids && !filter.ids.length)\n    return 0;\n  if (filter.kinds && !filter.kinds.length)\n    return 0;\n  if (filter.authors && !filter.authors.length)\n    return 0;\n  return Math.min(\n    Math.max(0, filter.limit ?? Infinity),\n    filter.ids?.length ?? Infinity,\n    filter.authors?.length && filter.kinds?.every((kind) => isReplaceableKind(kind)) ? filter.authors.length * filter.kinds.length : Infinity\n  );\n}\n\n// fakejson.ts\nvar fakejson_exports = {};\n__export(fakejson_exports, {\n  getHex64: () => getHex64,\n  getInt: () => getInt,\n  getSubscriptionId: () => getSubscriptionId,\n  matchEventId: () => matchEventId,\n  matchEventKind: () => matchEventKind,\n  matchEventPubkey: () => matchEventPubkey\n});\nfunction getHex64(json, field) {\n  let len = field.length + 3;\n  let idx = json.indexOf(`\"${field}\":`) + len;\n  let s = json.slice(idx).indexOf(`\"`) + idx + 1;\n  return json.slice(s, s + 64);\n}\nfunction getInt(json, field) {\n  let len = field.length;\n  let idx = json.indexOf(`\"${field}\":`) + len + 3;\n  let sliced = json.slice(idx);\n  let end = Math.min(sliced.indexOf(\",\"), sliced.indexOf(\"}\"));\n  return parseInt(sliced.slice(0, end), 10);\n}\nfunction getSubscriptionId(json) {\n  let idx = json.slice(0, 22).indexOf(`\"EVENT\"`);\n  if (idx === -1)\n    return null;\n  let pstart = json.slice(idx + 7 + 1).indexOf(`\"`);\n  if (pstart === -1)\n    return null;\n  let start = idx + 7 + 1 + pstart;\n  let pend = json.slice(start + 1, 80).indexOf(`\"`);\n  if (pend === -1)\n    return null;\n  let end = start + 1 + pend;\n  return json.slice(start + 1, end);\n}\nfunction matchEventId(json, id) {\n  return id === getHex64(json, \"id\");\n}\nfunction matchEventPubkey(json, pubkey) {\n  return pubkey === getHex64(json, \"pubkey\");\n}\nfunction matchEventKind(json, kind) {\n  return kind === getInt(json, \"kind\");\n}\n\n// nip42.ts\nvar nip42_exports = {};\n__export(nip42_exports, {\n  makeAuthEvent: () => makeAuthEvent\n});\nfunction makeAuthEvent(relayURL, challenge) {\n  return {\n    kind: ClientAuth,\n    created_at: Math.floor(Date.now() / 1e3),\n    tags: [\n      [\"relay\", relayURL],\n      [\"challenge\", challenge]\n    ],\n    content: \"\"\n  };\n}\n\n// helpers.ts\nasync function yieldThread() {\n  return new Promise((resolve) => {\n    const ch = new MessageChannel();\n    const handler = () => {\n      ch.port1.removeEventListener(\"message\", handler);\n      resolve();\n    };\n    ch.port1.addEventListener(\"message\", handler);\n    ch.port2.postMessage(0);\n    ch.port1.start();\n  });\n}\nvar alwaysTrue = (t) => {\n  t[verifiedSymbol] = true;\n  return true;\n};\n\n// abstract-relay.ts\nvar AbstractRelay = class {\n  url;\n  _connected = false;\n  onclose = null;\n  onnotice = (msg) => console.debug(`NOTICE from ${this.url}: ${msg}`);\n  baseEoseTimeout = 4400;\n  connectionTimeout = 4400;\n  openSubs = /* @__PURE__ */ new Map();\n  connectionTimeoutHandle;\n  connectionPromise;\n  openCountRequests = /* @__PURE__ */ new Map();\n  openEventPublishes = /* @__PURE__ */ new Map();\n  ws;\n  incomingMessageQueue = new Queue();\n  queueRunning = false;\n  challenge;\n  serial = 0;\n  verifyEvent;\n  constructor(url, opts) {\n    this.url = normalizeURL(url);\n    this.verifyEvent = opts.verifyEvent;\n  }\n  static async connect(url, opts) {\n    const relay = new AbstractRelay(url, opts);\n    await relay.connect();\n    return relay;\n  }\n  closeAllSubscriptions(reason) {\n    for (let [_, sub] of this.openSubs) {\n      sub.close(reason);\n    }\n    this.openSubs.clear();\n    for (let [_, ep] of this.openEventPublishes) {\n      ep.reject(new Error(reason));\n    }\n    this.openEventPublishes.clear();\n    for (let [_, cr] of this.openCountRequests) {\n      cr.reject(new Error(reason));\n    }\n    this.openCountRequests.clear();\n  }\n  get connected() {\n    return this._connected;\n  }\n  async connect() {\n    if (this.connectionPromise)\n      return this.connectionPromise;\n    this.challenge = void 0;\n    this.connectionPromise = new Promise((resolve, reject) => {\n      this.connectionTimeoutHandle = setTimeout(() => {\n        reject(\"connection timed out\");\n        this.connectionPromise = void 0;\n        this.onclose?.();\n        this.closeAllSubscriptions(\"relay connection timed out\");\n      }, this.connectionTimeout);\n      try {\n        this.ws = new WebSocket(this.url);\n      } catch (err) {\n        reject(err);\n        return;\n      }\n      this.ws.onopen = () => {\n        clearTimeout(this.connectionTimeoutHandle);\n        this._connected = true;\n        resolve();\n      };\n      this.ws.onerror = (ev) => {\n        reject(ev.message);\n        if (this._connected) {\n          this.onclose?.();\n          this.closeAllSubscriptions(\"relay connection errored\");\n          this._connected = false;\n        }\n      };\n      this.ws.onclose = async () => {\n        this.connectionPromise = void 0;\n        this.onclose?.();\n        this.closeAllSubscriptions(\"relay connection closed\");\n        this._connected = false;\n      };\n      this.ws.onmessage = this._onmessage.bind(this);\n    });\n    return this.connectionPromise;\n  }\n  async runQueue() {\n    this.queueRunning = true;\n    while (true) {\n      if (false === this.handleNext()) {\n        break;\n      }\n      await yieldThread();\n    }\n    this.queueRunning = false;\n  }\n  handleNext() {\n    const json = this.incomingMessageQueue.dequeue();\n    if (!json) {\n      return false;\n    }\n    const subid = getSubscriptionId(json);\n    if (subid) {\n      const so = this.openSubs.get(subid);\n      if (!so) {\n        return;\n      }\n      const id = getHex64(json, \"id\");\n      const alreadyHave = so.alreadyHaveEvent?.(id);\n      so.receivedEvent?.(this, id);\n      if (alreadyHave) {\n        return;\n      }\n    }\n    try {\n      let data = JSON.parse(json);\n      switch (data[0]) {\n        case \"EVENT\": {\n          const so = this.openSubs.get(data[1]);\n          const event = data[2];\n          if (this.verifyEvent(event) && matchFilters(so.filters, event)) {\n            so.onevent(event);\n          }\n          return;\n        }\n        case \"COUNT\": {\n          const id = data[1];\n          const payload = data[2];\n          const cr = this.openCountRequests.get(id);\n          if (cr) {\n            cr.resolve(payload.count);\n            this.openCountRequests.delete(id);\n          }\n          return;\n        }\n        case \"EOSE\": {\n          const so = this.openSubs.get(data[1]);\n          if (!so)\n            return;\n          so.receivedEose();\n          return;\n        }\n        case \"OK\": {\n          const id = data[1];\n          const ok = data[2];\n          const reason = data[3];\n          const ep = this.openEventPublishes.get(id);\n          if (ok)\n            ep.resolve(reason);\n          else\n            ep.reject(new Error(reason));\n          this.openEventPublishes.delete(id);\n          return;\n        }\n        case \"CLOSED\": {\n          const id = data[1];\n          const so = this.openSubs.get(id);\n          if (!so)\n            return;\n          so.closed = true;\n          so.close(data[2]);\n          return;\n        }\n        case \"NOTICE\":\n          this.onnotice(data[1]);\n          return;\n        case \"AUTH\": {\n          this.challenge = data[1];\n          return;\n        }\n      }\n    } catch (err) {\n      return;\n    }\n  }\n  async send(message) {\n    if (!this.connectionPromise)\n      throw new Error(\"sending on closed connection\");\n    this.connectionPromise.then(() => {\n      this.ws?.send(message);\n    });\n  }\n  async auth(signAuthEvent) {\n    if (!this.challenge)\n      throw new Error(\"can't perform auth, no challenge was received\");\n    const evt = await signAuthEvent(makeAuthEvent(this.url, this.challenge));\n    const ret = new Promise((resolve, reject) => {\n      this.openEventPublishes.set(evt.id, { resolve, reject });\n    });\n    this.send('[\"AUTH\",' + JSON.stringify(evt) + \"]\");\n    return ret;\n  }\n  async publish(event) {\n    const ret = new Promise((resolve, reject) => {\n      this.openEventPublishes.set(event.id, { resolve, reject });\n    });\n    this.send('[\"EVENT\",' + JSON.stringify(event) + \"]\");\n    return ret;\n  }\n  async count(filters, params) {\n    this.serial++;\n    const id = params?.id || \"count:\" + this.serial;\n    const ret = new Promise((resolve, reject) => {\n      this.openCountRequests.set(id, { resolve, reject });\n    });\n    this.send('[\"COUNT\",\"' + id + '\",' + JSON.stringify(filters) + \"]\");\n    return ret;\n  }\n  subscribe(filters, params) {\n    const subscription = this.prepareSubscription(filters, params);\n    subscription.fire();\n    return subscription;\n  }\n  prepareSubscription(filters, params) {\n    this.serial++;\n    const id = params.id || \"sub:\" + this.serial;\n    const subscription = new Subscription(this, id, filters, params);\n    this.openSubs.set(id, subscription);\n    return subscription;\n  }\n  close() {\n    this.closeAllSubscriptions(\"relay connection closed by us\");\n    this._connected = false;\n    this.ws?.close();\n  }\n  _onmessage(ev) {\n    this.incomingMessageQueue.enqueue(ev.data);\n    if (!this.queueRunning) {\n      this.runQueue();\n    }\n  }\n};\nvar Subscription = class {\n  relay;\n  id;\n  closed = false;\n  eosed = false;\n  filters;\n  alreadyHaveEvent;\n  receivedEvent;\n  onevent;\n  oneose;\n  onclose;\n  eoseTimeout;\n  eoseTimeoutHandle;\n  constructor(relay, id, filters, params) {\n    this.relay = relay;\n    this.filters = filters;\n    this.id = id;\n    this.alreadyHaveEvent = params.alreadyHaveEvent;\n    this.receivedEvent = params.receivedEvent;\n    this.eoseTimeout = params.eoseTimeout || relay.baseEoseTimeout;\n    this.oneose = params.oneose;\n    this.onclose = params.onclose;\n    this.onevent = params.onevent || ((event) => {\n      console.warn(\n        `onevent() callback not defined for subscription '${this.id}' in relay ${this.relay.url}. event received:`,\n        event\n      );\n    });\n  }\n  fire() {\n    this.relay.send('[\"REQ\",\"' + this.id + '\",' + JSON.stringify(this.filters).substring(1));\n    this.eoseTimeoutHandle = setTimeout(this.receivedEose.bind(this), this.eoseTimeout);\n  }\n  receivedEose() {\n    if (this.eosed)\n      return;\n    clearTimeout(this.eoseTimeoutHandle);\n    this.eosed = true;\n    this.oneose?.();\n  }\n  close(reason = \"closed by caller\") {\n    if (!this.closed) {\n      this.relay.send('[\"CLOSE\",' + JSON.stringify(this.id) + \"]\");\n      this.closed = true;\n    }\n    this.relay.openSubs.delete(this.id);\n    this.onclose?.(reason);\n  }\n};\n\n// relay.ts\nfunction relayConnect(url) {\n  return Relay.connect(url);\n}\nvar Relay = class extends AbstractRelay {\n  constructor(url) {\n    super(url, { verifyEvent });\n  }\n  static async connect(url) {\n    const relay = new Relay(url);\n    await relay.connect();\n    return relay;\n  }\n};\n\n// abstract-pool.ts\nvar AbstractSimplePool = class {\n  relays = /* @__PURE__ */ new Map();\n  seenOn = /* @__PURE__ */ new Map();\n  trackRelays = false;\n  verifyEvent;\n  trustedRelayURLs = /* @__PURE__ */ new Set();\n  constructor(opts) {\n    this.verifyEvent = opts.verifyEvent;\n  }\n  async ensureRelay(url, params) {\n    url = normalizeURL(url);\n    let relay = this.relays.get(url);\n    if (!relay) {\n      relay = new AbstractRelay(url, {\n        verifyEvent: this.trustedRelayURLs.has(url) ? alwaysTrue : this.verifyEvent\n      });\n      if (params?.connectionTimeout)\n        relay.connectionTimeout = params.connectionTimeout;\n      this.relays.set(url, relay);\n    }\n    await relay.connect();\n    return relay;\n  }\n  close(relays) {\n    relays.map(normalizeURL).forEach((url) => {\n      this.relays.get(url)?.close();\n    });\n  }\n  subscribeMany(relays, filters, params) {\n    if (this.trackRelays) {\n      params.receivedEvent = (relay, id) => {\n        let set = this.seenOn.get(id);\n        if (!set) {\n          set = /* @__PURE__ */ new Set();\n          this.seenOn.set(id, set);\n        }\n        set.add(relay);\n      };\n    }\n    const _knownIds = /* @__PURE__ */ new Set();\n    const subs = [];\n    const eosesReceived = [];\n    let handleEose = (i2) => {\n      eosesReceived[i2] = true;\n      if (eosesReceived.filter((a) => a).length === relays.length) {\n        params.oneose?.();\n        handleEose = () => {\n        };\n      }\n    };\n    const closesReceived = [];\n    let handleClose = (i2, reason) => {\n      handleEose(i2);\n      closesReceived[i2] = reason;\n      if (closesReceived.filter((a) => a).length === relays.length) {\n        params.onclose?.(closesReceived);\n        handleClose = () => {\n        };\n      }\n    };\n    const localAlreadyHaveEventHandler = (id) => {\n      if (params.alreadyHaveEvent?.(id)) {\n        return true;\n      }\n      const have = _knownIds.has(id);\n      _knownIds.add(id);\n      return have;\n    };\n    const allOpened = Promise.all(\n      relays.map(normalizeURL).map(async (url, i2, arr) => {\n        if (arr.indexOf(url) !== i2) {\n          handleClose(i2, \"duplicate url\");\n          return;\n        }\n        let relay;\n        try {\n          relay = await this.ensureRelay(url, {\n            connectionTimeout: params.maxWait ? Math.max(params.maxWait * 0.8, params.maxWait - 1e3) : void 0\n          });\n        } catch (err) {\n          handleClose(i2, err?.message || String(err));\n          return;\n        }\n        let subscription = relay.subscribe(filters, {\n          ...params,\n          oneose: () => handleEose(i2),\n          onclose: (reason) => handleClose(i2, reason),\n          alreadyHaveEvent: localAlreadyHaveEventHandler,\n          eoseTimeout: params.maxWait\n        });\n        subs.push(subscription);\n      })\n    );\n    return {\n      async close() {\n        await allOpened;\n        subs.forEach((sub) => {\n          sub.close();\n        });\n      }\n    };\n  }\n  subscribeManyEose(relays, filters, params) {\n    const subcloser = this.subscribeMany(relays, filters, {\n      ...params,\n      oneose() {\n        subcloser.close();\n      }\n    });\n    return subcloser;\n  }\n  async querySync(relays, filter, params) {\n    return new Promise(async (resolve) => {\n      const events = [];\n      this.subscribeManyEose(relays, [filter], {\n        ...params,\n        onevent(event) {\n          events.push(event);\n        },\n        onclose(_) {\n          resolve(events);\n        }\n      });\n    });\n  }\n  async get(relays, filter, params) {\n    filter.limit = 1;\n    const events = await this.querySync(relays, filter, params);\n    events.sort((a, b) => b.created_at - a.created_at);\n    return events[0] || null;\n  }\n  publish(relays, event) {\n    return relays.map(normalizeURL).map(async (url, i2, arr) => {\n      if (arr.indexOf(url) !== i2) {\n        return Promise.reject(\"duplicate url\");\n      }\n      let r = await this.ensureRelay(url);\n      return r.publish(event);\n    });\n  }\n};\n\n// pool.ts\nvar SimplePool = class extends AbstractSimplePool {\n  constructor() {\n    super({ verifyEvent });\n  }\n};\n\n// nip19.ts\nvar nip19_exports = {};\n__export(nip19_exports, {\n  BECH32_REGEX: () => BECH32_REGEX,\n  decode: () => decode,\n  naddrEncode: () => naddrEncode,\n  neventEncode: () => neventEncode,\n  noteEncode: () => noteEncode,\n  nprofileEncode: () => nprofileEncode,\n  npubEncode: () => npubEncode,\n  nrelayEncode: () => nrelayEncode,\n  nsecEncode: () => nsecEncode\n});\nimport { bytesToHex as bytesToHex2, concatBytes, hexToBytes } from \"@noble/hashes/utils\";\nimport { bech32 } from \"@scure/base\";\nvar Bech32MaxSize = 5e3;\nvar BECH32_REGEX = /[\\x21-\\x7E]{1,83}1[023456789acdefghjklmnpqrstuvwxyz]{6,}/;\nfunction integerToUint8Array(number) {\n  const uint8Array = new Uint8Array(4);\n  uint8Array[0] = number >> 24 & 255;\n  uint8Array[1] = number >> 16 & 255;\n  uint8Array[2] = number >> 8 & 255;\n  uint8Array[3] = number & 255;\n  return uint8Array;\n}\nfunction decode(nip19) {\n  let { prefix, words } = bech32.decode(nip19, Bech32MaxSize);\n  let data = new Uint8Array(bech32.fromWords(words));\n  switch (prefix) {\n    case \"nprofile\": {\n      let tlv = parseTLV(data);\n      if (!tlv[0]?.[0])\n        throw new Error(\"missing TLV 0 for nprofile\");\n      if (tlv[0][0].length !== 32)\n        throw new Error(\"TLV 0 should be 32 bytes\");\n      return {\n        type: \"nprofile\",\n        data: {\n          pubkey: bytesToHex2(tlv[0][0]),\n          relays: tlv[1] ? tlv[1].map((d) => utf8Decoder.decode(d)) : []\n        }\n      };\n    }\n    case \"nevent\": {\n      let tlv = parseTLV(data);\n      if (!tlv[0]?.[0])\n        throw new Error(\"missing TLV 0 for nevent\");\n      if (tlv[0][0].length !== 32)\n        throw new Error(\"TLV 0 should be 32 bytes\");\n      if (tlv[2] && tlv[2][0].length !== 32)\n        throw new Error(\"TLV 2 should be 32 bytes\");\n      if (tlv[3] && tlv[3][0].length !== 4)\n        throw new Error(\"TLV 3 should be 4 bytes\");\n      return {\n        type: \"nevent\",\n        data: {\n          id: bytesToHex2(tlv[0][0]),\n          relays: tlv[1] ? tlv[1].map((d) => utf8Decoder.decode(d)) : [],\n          author: tlv[2]?.[0] ? bytesToHex2(tlv[2][0]) : void 0,\n          kind: tlv[3]?.[0] ? parseInt(bytesToHex2(tlv[3][0]), 16) : void 0\n        }\n      };\n    }\n    case \"naddr\": {\n      let tlv = parseTLV(data);\n      if (!tlv[0]?.[0])\n        throw new Error(\"missing TLV 0 for naddr\");\n      if (!tlv[2]?.[0])\n        throw new Error(\"missing TLV 2 for naddr\");\n      if (tlv[2][0].length !== 32)\n        throw new Error(\"TLV 2 should be 32 bytes\");\n      if (!tlv[3]?.[0])\n        throw new Error(\"missing TLV 3 for naddr\");\n      if (tlv[3][0].length !== 4)\n        throw new Error(\"TLV 3 should be 4 bytes\");\n      return {\n        type: \"naddr\",\n        data: {\n          identifier: utf8Decoder.decode(tlv[0][0]),\n          pubkey: bytesToHex2(tlv[2][0]),\n          kind: parseInt(bytesToHex2(tlv[3][0]), 16),\n          relays: tlv[1] ? tlv[1].map((d) => utf8Decoder.decode(d)) : []\n        }\n      };\n    }\n    case \"nrelay\": {\n      let tlv = parseTLV(data);\n      if (!tlv[0]?.[0])\n        throw new Error(\"missing TLV 0 for nrelay\");\n      return {\n        type: \"nrelay\",\n        data: utf8Decoder.decode(tlv[0][0])\n      };\n    }\n    case \"nsec\":\n      return { type: prefix, data };\n    case \"npub\":\n    case \"note\":\n      return { type: prefix, data: bytesToHex2(data) };\n    default:\n      throw new Error(`unknown prefix ${prefix}`);\n  }\n}\nfunction parseTLV(data) {\n  let result = {};\n  let rest = data;\n  while (rest.length > 0) {\n    let t = rest[0];\n    let l = rest[1];\n    let v = rest.slice(2, 2 + l);\n    rest = rest.slice(2 + l);\n    if (v.length < l)\n      throw new Error(`not enough data to read on TLV ${t}`);\n    result[t] = result[t] || [];\n    result[t].push(v);\n  }\n  return result;\n}\nfunction nsecEncode(key) {\n  return encodeBytes(\"nsec\", key);\n}\nfunction npubEncode(hex) {\n  return encodeBytes(\"npub\", hexToBytes(hex));\n}\nfunction noteEncode(hex) {\n  return encodeBytes(\"note\", hexToBytes(hex));\n}\nfunction encodeBech32(prefix, data) {\n  let words = bech32.toWords(data);\n  return bech32.encode(prefix, words, Bech32MaxSize);\n}\nfunction encodeBytes(prefix, bytes) {\n  return encodeBech32(prefix, bytes);\n}\nfunction nprofileEncode(profile) {\n  let data = encodeTLV({\n    0: [hexToBytes(profile.pubkey)],\n    1: (profile.relays || []).map((url) => utf8Encoder.encode(url))\n  });\n  return encodeBech32(\"nprofile\", data);\n}\nfunction neventEncode(event) {\n  let kindArray;\n  if (event.kind !== void 0) {\n    kindArray = integerToUint8Array(event.kind);\n  }\n  let data = encodeTLV({\n    0: [hexToBytes(event.id)],\n    1: (event.relays || []).map((url) => utf8Encoder.encode(url)),\n    2: event.author ? [hexToBytes(event.author)] : [],\n    3: kindArray ? [new Uint8Array(kindArray)] : []\n  });\n  return encodeBech32(\"nevent\", data);\n}\nfunction naddrEncode(addr) {\n  let kind = new ArrayBuffer(4);\n  new DataView(kind).setUint32(0, addr.kind, false);\n  let data = encodeTLV({\n    0: [utf8Encoder.encode(addr.identifier)],\n    1: (addr.relays || []).map((url) => utf8Encoder.encode(url)),\n    2: [hexToBytes(addr.pubkey)],\n    3: [new Uint8Array(kind)]\n  });\n  return encodeBech32(\"naddr\", data);\n}\nfunction nrelayEncode(url) {\n  let data = encodeTLV({\n    0: [utf8Encoder.encode(url)]\n  });\n  return encodeBech32(\"nrelay\", data);\n}\nfunction encodeTLV(tlv) {\n  let entries = [];\n  Object.entries(tlv).reverse().forEach(([t, vs]) => {\n    vs.forEach((v) => {\n      let entry = new Uint8Array(v.length + 2);\n      entry.set([parseInt(t)], 0);\n      entry.set([v.length], 1);\n      entry.set(v, 2);\n      entries.push(entry);\n    });\n  });\n  return concatBytes(...entries);\n}\n\n// references.ts\nvar mentionRegex = /\\bnostr:((note|npub|naddr|nevent|nprofile)1\\w+)\\b|#\\[(\\d+)\\]/g;\nfunction parseReferences(evt) {\n  let references = [];\n  for (let ref of evt.content.matchAll(mentionRegex)) {\n    if (ref[2]) {\n      try {\n        let { type, data } = decode(ref[1]);\n        switch (type) {\n          case \"npub\": {\n            references.push({\n              text: ref[0],\n              profile: { pubkey: data, relays: [] }\n            });\n            break;\n          }\n          case \"nprofile\": {\n            references.push({\n              text: ref[0],\n              profile: data\n            });\n            break;\n          }\n          case \"note\": {\n            references.push({\n              text: ref[0],\n              event: { id: data, relays: [] }\n            });\n            break;\n          }\n          case \"nevent\": {\n            references.push({\n              text: ref[0],\n              event: data\n            });\n            break;\n          }\n          case \"naddr\": {\n            references.push({\n              text: ref[0],\n              address: data\n            });\n            break;\n          }\n        }\n      } catch (err) {\n      }\n    } else if (ref[3]) {\n      let idx = parseInt(ref[3], 10);\n      let tag = evt.tags[idx];\n      if (!tag)\n        continue;\n      switch (tag[0]) {\n        case \"p\": {\n          references.push({\n            text: ref[0],\n            profile: { pubkey: tag[1], relays: tag[2] ? [tag[2]] : [] }\n          });\n          break;\n        }\n        case \"e\": {\n          references.push({\n            text: ref[0],\n            event: { id: tag[1], relays: tag[2] ? [tag[2]] : [] }\n          });\n          break;\n        }\n        case \"a\": {\n          try {\n            let [kind, pubkey, identifier] = tag[1].split(\":\");\n            references.push({\n              text: ref[0],\n              address: {\n                identifier,\n                pubkey,\n                kind: parseInt(kind, 10),\n                relays: tag[2] ? [tag[2]] : []\n              }\n            });\n          } catch (err) {\n          }\n          break;\n        }\n      }\n    }\n  }\n  return references;\n}\n\n// nip04.ts\nvar nip04_exports = {};\n__export(nip04_exports, {\n  decrypt: () => decrypt,\n  encrypt: () => encrypt\n});\nimport { bytesToHex as bytesToHex3, randomBytes } from \"@noble/hashes/utils\";\nimport { secp256k1 } from \"@noble/curves/secp256k1\";\nimport { base64 } from \"@scure/base\";\nif (typeof crypto !== \"undefined\" && !crypto.subtle && crypto.webcrypto) {\n  crypto.subtle = crypto.webcrypto.subtle;\n}\nasync function encrypt(secretKey, pubkey, text) {\n  const privkey = secretKey instanceof Uint8Array ? bytesToHex3(secretKey) : secretKey;\n  const key = secp256k1.getSharedSecret(privkey, \"02\" + pubkey);\n  const normalizedKey = getNormalizedX(key);\n  let iv = Uint8Array.from(randomBytes(16));\n  let plaintext = utf8Encoder.encode(text);\n  let cryptoKey = await crypto.subtle.importKey(\"raw\", normalizedKey, { name: \"AES-CBC\" }, false, [\"encrypt\"]);\n  let ciphertext = await crypto.subtle.encrypt({ name: \"AES-CBC\", iv }, cryptoKey, plaintext);\n  let ctb64 = base64.encode(new Uint8Array(ciphertext));\n  let ivb64 = base64.encode(new Uint8Array(iv.buffer));\n  return `${ctb64}?iv=${ivb64}`;\n}\nasync function decrypt(secretKey, pubkey, data) {\n  const privkey = secretKey instanceof Uint8Array ? bytesToHex3(secretKey) : secretKey;\n  let [ctb64, ivb64] = data.split(\"?iv=\");\n  let key = secp256k1.getSharedSecret(privkey, \"02\" + pubkey);\n  let normalizedKey = getNormalizedX(key);\n  let cryptoKey = await crypto.subtle.importKey(\"raw\", normalizedKey, { name: \"AES-CBC\" }, false, [\"decrypt\"]);\n  let ciphertext = base64.decode(ctb64);\n  let iv = base64.decode(ivb64);\n  let plaintext = await crypto.subtle.decrypt({ name: \"AES-CBC\", iv }, cryptoKey, ciphertext);\n  let text = utf8Decoder.decode(plaintext);\n  return text;\n}\nfunction getNormalizedX(key) {\n  return key.slice(1, 33);\n}\n\n// nip05.ts\nvar nip05_exports = {};\n__export(nip05_exports, {\n  NIP05_REGEX: () => NIP05_REGEX,\n  queryProfile: () => queryProfile,\n  searchDomain: () => searchDomain,\n  useFetchImplementation: () => useFetchImplementation\n});\nvar NIP05_REGEX = /^(?:([\\w.+-]+)@)?([\\w.-]+)$/;\nvar _fetch;\ntry {\n  _fetch = fetch;\n} catch {\n}\nfunction useFetchImplementation(fetchImplementation) {\n  _fetch = fetchImplementation;\n}\nasync function searchDomain(domain, query = \"\") {\n  try {\n    let res = await (await _fetch(`https://${domain}/.well-known/nostr.json?name=${query}`)).json();\n    return res.names;\n  } catch (_) {\n    return {};\n  }\n}\nasync function queryProfile(fullname) {\n  const match = fullname.match(NIP05_REGEX);\n  if (!match)\n    return null;\n  const [_, name = \"_\", domain] = match;\n  try {\n    const res = await _fetch(`https://${domain}/.well-known/nostr.json?name=${name}`);\n    const { names, relays } = parseNIP05Result(await res.json());\n    const pubkey = names[name];\n    return pubkey ? { pubkey, relays: relays?.[pubkey] } : null;\n  } catch (_e) {\n    return null;\n  }\n}\nfunction parseNIP05Result(json) {\n  const result = {\n    names: {}\n  };\n  for (const [name, pubkey] of Object.entries(json.names)) {\n    if (typeof name === \"string\" && typeof pubkey === \"string\") {\n      result.names[name] = pubkey;\n    }\n  }\n  if (json.relays) {\n    result.relays = {};\n    for (const [pubkey, relays] of Object.entries(json.relays)) {\n      if (typeof pubkey === \"string\" && Array.isArray(relays)) {\n        result.relays[pubkey] = relays.filter((relay) => typeof relay === \"string\");\n      }\n    }\n  }\n  return result;\n}\n\n// nip10.ts\nvar nip10_exports = {};\n__export(nip10_exports, {\n  parse: () => parse\n});\nfunction parse(event) {\n  const result = {\n    reply: void 0,\n    root: void 0,\n    mentions: [],\n    profiles: []\n  };\n  const eTags = [];\n  for (const tag of event.tags) {\n    if (tag[0] === \"e\" && tag[1]) {\n      eTags.push(tag);\n    }\n    if (tag[0] === \"p\" && tag[1]) {\n      result.profiles.push({\n        pubkey: tag[1],\n        relays: tag[2] ? [tag[2]] : []\n      });\n    }\n  }\n  for (let eTagIndex = 0; eTagIndex < eTags.length; eTagIndex++) {\n    const eTag = eTags[eTagIndex];\n    const [_, eTagEventId, eTagRelayUrl, eTagMarker] = eTag;\n    const eventPointer = {\n      id: eTagEventId,\n      relays: eTagRelayUrl ? [eTagRelayUrl] : []\n    };\n    const isFirstETag = eTagIndex === 0;\n    const isLastETag = eTagIndex === eTags.length - 1;\n    if (eTagMarker === \"root\") {\n      result.root = eventPointer;\n      continue;\n    }\n    if (eTagMarker === \"reply\") {\n      result.reply = eventPointer;\n      continue;\n    }\n    if (eTagMarker === \"mention\") {\n      result.mentions.push(eventPointer);\n      continue;\n    }\n    if (isFirstETag) {\n      result.root = eventPointer;\n      continue;\n    }\n    if (isLastETag) {\n      result.reply = eventPointer;\n      continue;\n    }\n    result.mentions.push(eventPointer);\n  }\n  return result;\n}\n\n// nip11.ts\nvar nip11_exports = {};\n__export(nip11_exports, {\n  fetchRelayInformation: () => fetchRelayInformation,\n  useFetchImplementation: () => useFetchImplementation2\n});\nvar _fetch2;\ntry {\n  _fetch2 = fetch;\n} catch {\n}\nfunction useFetchImplementation2(fetchImplementation) {\n  _fetch2 = fetchImplementation;\n}\nasync function fetchRelayInformation(url) {\n  return await (await fetch(url.replace(\"ws://\", \"http://\").replace(\"wss://\", \"https://\"), {\n    headers: { Accept: \"application/nostr+json\" }\n  })).json();\n}\n\n// nip13.ts\nvar nip13_exports = {};\n__export(nip13_exports, {\n  getPow: () => getPow,\n  minePow: () => minePow\n});\nfunction getPow(hex) {\n  let count = 0;\n  for (let i2 = 0; i2 < hex.length; i2++) {\n    const nibble = parseInt(hex[i2], 16);\n    if (nibble === 0) {\n      count += 4;\n    } else {\n      count += Math.clz32(nibble) - 28;\n      break;\n    }\n  }\n  return count;\n}\nfunction minePow(unsigned, difficulty) {\n  let count = 0;\n  const event = unsigned;\n  const tag = [\"nonce\", count.toString(), difficulty.toString()];\n  event.tags.push(tag);\n  while (true) {\n    const now = Math.floor(new Date().getTime() / 1e3);\n    if (now !== event.created_at) {\n      count = 0;\n      event.created_at = now;\n    }\n    tag[1] = (++count).toString();\n    event.id = getEventHash(event);\n    if (getPow(event.id) >= difficulty) {\n      break;\n    }\n  }\n  return event;\n}\n\n// nip18.ts\nvar nip18_exports = {};\n__export(nip18_exports, {\n  finishRepostEvent: () => finishRepostEvent,\n  getRepostedEvent: () => getRepostedEvent,\n  getRepostedEventPointer: () => getRepostedEventPointer\n});\nfunction finishRepostEvent(t, reposted, relayUrl, privateKey) {\n  return finalizeEvent(\n    {\n      kind: Repost,\n      tags: [...t.tags ?? [], [\"e\", reposted.id, relayUrl], [\"p\", reposted.pubkey]],\n      content: t.content === \"\" ? \"\" : JSON.stringify(reposted),\n      created_at: t.created_at\n    },\n    privateKey\n  );\n}\nfunction getRepostedEventPointer(event) {\n  if (event.kind !== Repost) {\n    return void 0;\n  }\n  let lastETag;\n  let lastPTag;\n  for (let i2 = event.tags.length - 1; i2 >= 0 && (lastETag === void 0 || lastPTag === void 0); i2--) {\n    const tag = event.tags[i2];\n    if (tag.length >= 2) {\n      if (tag[0] === \"e\" && lastETag === void 0) {\n        lastETag = tag;\n      } else if (tag[0] === \"p\" && lastPTag === void 0) {\n        lastPTag = tag;\n      }\n    }\n  }\n  if (lastETag === void 0) {\n    return void 0;\n  }\n  return {\n    id: lastETag[1],\n    relays: [lastETag[2], lastPTag?.[2]].filter((x) => typeof x === \"string\"),\n    author: lastPTag?.[1]\n  };\n}\nfunction getRepostedEvent(event, { skipVerification } = {}) {\n  const pointer = getRepostedEventPointer(event);\n  if (pointer === void 0 || event.content === \"\") {\n    return void 0;\n  }\n  let repostedEvent;\n  try {\n    repostedEvent = JSON.parse(event.content);\n  } catch (error) {\n    return void 0;\n  }\n  if (repostedEvent.id !== pointer.id) {\n    return void 0;\n  }\n  if (!skipVerification && !verifyEvent(repostedEvent)) {\n    return void 0;\n  }\n  return repostedEvent;\n}\n\n// nip21.ts\nvar nip21_exports = {};\n__export(nip21_exports, {\n  NOSTR_URI_REGEX: () => NOSTR_URI_REGEX,\n  parse: () => parse2,\n  test: () => test\n});\nvar NOSTR_URI_REGEX = new RegExp(`nostr:(${BECH32_REGEX.source})`);\nfunction test(value) {\n  return typeof value === \"string\" && new RegExp(`^${NOSTR_URI_REGEX.source}$`).test(value);\n}\nfunction parse2(uri) {\n  const match = uri.match(new RegExp(`^${NOSTR_URI_REGEX.source}$`));\n  if (!match)\n    throw new Error(`Invalid Nostr URI: ${uri}`);\n  return {\n    uri: match[0],\n    value: match[1],\n    decoded: decode(match[1])\n  };\n}\n\n// nip25.ts\nvar nip25_exports = {};\n__export(nip25_exports, {\n  finishReactionEvent: () => finishReactionEvent,\n  getReactedEventPointer: () => getReactedEventPointer\n});\nfunction finishReactionEvent(t, reacted, privateKey) {\n  const inheritedTags = reacted.tags.filter((tag) => tag.length >= 2 && (tag[0] === \"e\" || tag[0] === \"p\"));\n  return finalizeEvent(\n    {\n      ...t,\n      kind: Reaction,\n      tags: [...t.tags ?? [], ...inheritedTags, [\"e\", reacted.id], [\"p\", reacted.pubkey]],\n      content: t.content ?? \"+\"\n    },\n    privateKey\n  );\n}\nfunction getReactedEventPointer(event) {\n  if (event.kind !== Reaction) {\n    return void 0;\n  }\n  let lastETag;\n  let lastPTag;\n  for (let i2 = event.tags.length - 1; i2 >= 0 && (lastETag === void 0 || lastPTag === void 0); i2--) {\n    const tag = event.tags[i2];\n    if (tag.length >= 2) {\n      if (tag[0] === \"e\" && lastETag === void 0) {\n        lastETag = tag;\n      } else if (tag[0] === \"p\" && lastPTag === void 0) {\n        lastPTag = tag;\n      }\n    }\n  }\n  if (lastETag === void 0 || lastPTag === void 0) {\n    return void 0;\n  }\n  return {\n    id: lastETag[1],\n    relays: [lastETag[2], lastPTag[2]].filter((x) => x !== void 0),\n    author: lastPTag[1]\n  };\n}\n\n// nip27.ts\nvar nip27_exports = {};\n__export(nip27_exports, {\n  matchAll: () => matchAll,\n  regex: () => regex,\n  replaceAll: () => replaceAll\n});\nvar regex = () => new RegExp(`\\\\b${NOSTR_URI_REGEX.source}\\\\b`, \"g\");\nfunction* matchAll(content) {\n  const matches = content.matchAll(regex());\n  for (const match of matches) {\n    try {\n      const [uri, value] = match;\n      yield {\n        uri,\n        value,\n        decoded: decode(value),\n        start: match.index,\n        end: match.index + uri.length\n      };\n    } catch (_e) {\n    }\n  }\n}\nfunction replaceAll(content, replacer) {\n  return content.replaceAll(regex(), (uri, value) => {\n    return replacer({\n      uri,\n      value,\n      decoded: decode(value)\n    });\n  });\n}\n\n// nip28.ts\nvar nip28_exports = {};\n__export(nip28_exports, {\n  channelCreateEvent: () => channelCreateEvent,\n  channelHideMessageEvent: () => channelHideMessageEvent,\n  channelMessageEvent: () => channelMessageEvent,\n  channelMetadataEvent: () => channelMetadataEvent,\n  channelMuteUserEvent: () => channelMuteUserEvent\n});\nvar channelCreateEvent = (t, privateKey) => {\n  let content;\n  if (typeof t.content === \"object\") {\n    content = JSON.stringify(t.content);\n  } else if (typeof t.content === \"string\") {\n    content = t.content;\n  } else {\n    return void 0;\n  }\n  return finalizeEvent(\n    {\n      kind: ChannelCreation,\n      tags: [...t.tags ?? []],\n      content,\n      created_at: t.created_at\n    },\n    privateKey\n  );\n};\nvar channelMetadataEvent = (t, privateKey) => {\n  let content;\n  if (typeof t.content === \"object\") {\n    content = JSON.stringify(t.content);\n  } else if (typeof t.content === \"string\") {\n    content = t.content;\n  } else {\n    return void 0;\n  }\n  return finalizeEvent(\n    {\n      kind: ChannelMetadata,\n      tags: [[\"e\", t.channel_create_event_id], ...t.tags ?? []],\n      content,\n      created_at: t.created_at\n    },\n    privateKey\n  );\n};\nvar channelMessageEvent = (t, privateKey) => {\n  const tags = [[\"e\", t.channel_create_event_id, t.relay_url, \"root\"]];\n  if (t.reply_to_channel_message_event_id) {\n    tags.push([\"e\", t.reply_to_channel_message_event_id, t.relay_url, \"reply\"]);\n  }\n  return finalizeEvent(\n    {\n      kind: ChannelMessage,\n      tags: [...tags, ...t.tags ?? []],\n      content: t.content,\n      created_at: t.created_at\n    },\n    privateKey\n  );\n};\nvar channelHideMessageEvent = (t, privateKey) => {\n  let content;\n  if (typeof t.content === \"object\") {\n    content = JSON.stringify(t.content);\n  } else if (typeof t.content === \"string\") {\n    content = t.content;\n  } else {\n    return void 0;\n  }\n  return finalizeEvent(\n    {\n      kind: ChannelHideMessage,\n      tags: [[\"e\", t.channel_message_event_id], ...t.tags ?? []],\n      content,\n      created_at: t.created_at\n    },\n    privateKey\n  );\n};\nvar channelMuteUserEvent = (t, privateKey) => {\n  let content;\n  if (typeof t.content === \"object\") {\n    content = JSON.stringify(t.content);\n  } else if (typeof t.content === \"string\") {\n    content = t.content;\n  } else {\n    return void 0;\n  }\n  return finalizeEvent(\n    {\n      kind: ChannelMuteUser,\n      tags: [[\"p\", t.pubkey_to_mute], ...t.tags ?? []],\n      content,\n      created_at: t.created_at\n    },\n    privateKey\n  );\n};\n\n// nip30.ts\nvar nip30_exports = {};\n__export(nip30_exports, {\n  EMOJI_SHORTCODE_REGEX: () => EMOJI_SHORTCODE_REGEX,\n  matchAll: () => matchAll2,\n  regex: () => regex2,\n  replaceAll: () => replaceAll2\n});\nvar EMOJI_SHORTCODE_REGEX = /:(\\w+):/;\nvar regex2 = () => new RegExp(`\\\\B${EMOJI_SHORTCODE_REGEX.source}\\\\B`, \"g\");\nfunction* matchAll2(content) {\n  const matches = content.matchAll(regex2());\n  for (const match of matches) {\n    try {\n      const [shortcode, name] = match;\n      yield {\n        shortcode,\n        name,\n        start: match.index,\n        end: match.index + shortcode.length\n      };\n    } catch (_e) {\n    }\n  }\n}\nfunction replaceAll2(content, replacer) {\n  return content.replaceAll(regex2(), (shortcode, name) => {\n    return replacer({\n      shortcode,\n      name\n    });\n  });\n}\n\n// nip39.ts\nvar nip39_exports = {};\n__export(nip39_exports, {\n  useFetchImplementation: () => useFetchImplementation3,\n  validateGithub: () => validateGithub\n});\nvar _fetch3;\ntry {\n  _fetch3 = fetch;\n} catch {\n}\nfunction useFetchImplementation3(fetchImplementation) {\n  _fetch3 = fetchImplementation;\n}\nasync function validateGithub(pubkey, username, proof) {\n  try {\n    let res = await (await _fetch3(`https://gist.github.com/${username}/${proof}/raw`)).text();\n    return res === `Verifying that I control the following Nostr public key: ${pubkey}`;\n  } catch (_) {\n    return false;\n  }\n}\n\n// nip44.ts\nvar nip44_exports = {};\n__export(nip44_exports, {\n  default: () => nip44_default,\n  v2: () => v2\n});\nimport { chacha20 } from \"@noble/ciphers/chacha\";\nimport { ensureBytes, equalBytes } from \"@noble/ciphers/utils\";\nimport { secp256k1 as secp256k12 } from \"@noble/curves/secp256k1\";\nimport { extract as hkdf_extract, expand as hkdf_expand } from \"@noble/hashes/hkdf\";\nimport { hmac } from \"@noble/hashes/hmac\";\nimport { sha256 as sha2562 } from \"@noble/hashes/sha256\";\nimport { concatBytes as concatBytes2, randomBytes as randomBytes2, utf8ToBytes } from \"@noble/hashes/utils\";\nimport { base64 as base642 } from \"@scure/base\";\nvar decoder = new TextDecoder();\nvar u = {\n  minPlaintextSize: 1,\n  maxPlaintextSize: 65535,\n  utf8Encode: utf8ToBytes,\n  utf8Decode(bytes) {\n    return decoder.decode(bytes);\n  },\n  getConversationKey(privkeyA, pubkeyB) {\n    const sharedX = secp256k12.getSharedSecret(privkeyA, \"02\" + pubkeyB).subarray(1, 33);\n    return hkdf_extract(sha2562, sharedX, \"nip44-v2\");\n  },\n  getMessageKeys(conversationKey, nonce) {\n    ensureBytes(conversationKey, 32);\n    ensureBytes(nonce, 32);\n    const keys = hkdf_expand(sha2562, conversationKey, nonce, 76);\n    return {\n      chacha_key: keys.subarray(0, 32),\n      chacha_nonce: keys.subarray(32, 44),\n      hmac_key: keys.subarray(44, 76)\n    };\n  },\n  calcPaddedLen(len) {\n    if (!Number.isSafeInteger(len) || len < 1)\n      throw new Error(\"expected positive integer\");\n    if (len <= 32)\n      return 32;\n    const nextPower = 1 << Math.floor(Math.log2(len - 1)) + 1;\n    const chunk = nextPower <= 256 ? 32 : nextPower / 8;\n    return chunk * (Math.floor((len - 1) / chunk) + 1);\n  },\n  writeU16BE(num) {\n    if (!Number.isSafeInteger(num) || num < u.minPlaintextSize || num > u.maxPlaintextSize)\n      throw new Error(\"invalid plaintext size: must be between 1 and 65535 bytes\");\n    const arr = new Uint8Array(2);\n    new DataView(arr.buffer).setUint16(0, num, false);\n    return arr;\n  },\n  pad(plaintext) {\n    const unpadded = u.utf8Encode(plaintext);\n    const unpaddedLen = unpadded.length;\n    const prefix = u.writeU16BE(unpaddedLen);\n    const suffix = new Uint8Array(u.calcPaddedLen(unpaddedLen) - unpaddedLen);\n    return concatBytes2(prefix, unpadded, suffix);\n  },\n  unpad(padded) {\n    const unpaddedLen = new DataView(padded.buffer).getUint16(0);\n    const unpadded = padded.subarray(2, 2 + unpaddedLen);\n    if (unpaddedLen < u.minPlaintextSize || unpaddedLen > u.maxPlaintextSize || unpadded.length !== unpaddedLen || padded.length !== 2 + u.calcPaddedLen(unpaddedLen))\n      throw new Error(\"invalid padding\");\n    return u.utf8Decode(unpadded);\n  },\n  hmacAad(key, message, aad) {\n    if (aad.length !== 32)\n      throw new Error(\"AAD associated data must be 32 bytes\");\n    const combined = concatBytes2(aad, message);\n    return hmac(sha2562, key, combined);\n  },\n  decodePayload(payload) {\n    if (typeof payload !== \"string\")\n      throw new Error(\"payload must be a valid string\");\n    const plen = payload.length;\n    if (plen < 132 || plen > 87472)\n      throw new Error(\"invalid payload length: \" + plen);\n    if (payload[0] === \"#\")\n      throw new Error(\"unknown encryption version\");\n    let data;\n    try {\n      data = base642.decode(payload);\n    } catch (error) {\n      throw new Error(\"invalid base64: \" + error.message);\n    }\n    const dlen = data.length;\n    if (dlen < 99 || dlen > 65603)\n      throw new Error(\"invalid data length: \" + dlen);\n    const vers = data[0];\n    if (vers !== 2)\n      throw new Error(\"unknown encryption version \" + vers);\n    return {\n      nonce: data.subarray(1, 33),\n      ciphertext: data.subarray(33, -32),\n      mac: data.subarray(-32)\n    };\n  }\n};\nfunction encrypt2(plaintext, conversationKey, nonce = randomBytes2(32)) {\n  const { chacha_key, chacha_nonce, hmac_key } = u.getMessageKeys(conversationKey, nonce);\n  const padded = u.pad(plaintext);\n  const ciphertext = chacha20(chacha_key, chacha_nonce, padded);\n  const mac = u.hmacAad(hmac_key, ciphertext, nonce);\n  return base642.encode(concatBytes2(new Uint8Array([2]), nonce, ciphertext, mac));\n}\nfunction decrypt2(payload, conversationKey) {\n  const { nonce, ciphertext, mac } = u.decodePayload(payload);\n  const { chacha_key, chacha_nonce, hmac_key } = u.getMessageKeys(conversationKey, nonce);\n  const calculatedMac = u.hmacAad(hmac_key, ciphertext, nonce);\n  if (!equalBytes(calculatedMac, mac))\n    throw new Error(\"invalid MAC\");\n  const padded = chacha20(chacha_key, chacha_nonce, ciphertext);\n  return u.unpad(padded);\n}\nvar v2 = {\n  utils: u,\n  encrypt: encrypt2,\n  decrypt: decrypt2\n};\nvar nip44_default = { v2 };\n\n// nip47.ts\nvar nip47_exports = {};\n__export(nip47_exports, {\n  makeNwcRequestEvent: () => makeNwcRequestEvent,\n  parseConnectionString: () => parseConnectionString\n});\nfunction parseConnectionString(connectionString) {\n  const { pathname, searchParams } = new URL(connectionString);\n  const pubkey = pathname;\n  const relay = searchParams.get(\"relay\");\n  const secret = searchParams.get(\"secret\");\n  if (!pubkey || !relay || !secret) {\n    throw new Error(\"invalid connection string\");\n  }\n  return { pubkey, relay, secret };\n}\nasync function makeNwcRequestEvent(pubkey, secretKey, invoice) {\n  const content = {\n    method: \"pay_invoice\",\n    params: {\n      invoice\n    }\n  };\n  const encryptedContent = await encrypt(secretKey, pubkey, JSON.stringify(content));\n  const eventTemplate = {\n    kind: NWCWalletRequest,\n    created_at: Math.round(Date.now() / 1e3),\n    content: encryptedContent,\n    tags: [[\"p\", pubkey]]\n  };\n  return finalizeEvent(eventTemplate, secretKey);\n}\n\n// nip57.ts\nvar nip57_exports = {};\n__export(nip57_exports, {\n  getZapEndpoint: () => getZapEndpoint,\n  makeZapReceipt: () => makeZapReceipt,\n  makeZapRequest: () => makeZapRequest,\n  useFetchImplementation: () => useFetchImplementation4,\n  validateZapRequest: () => validateZapRequest\n});\nimport { bech32 as bech322 } from \"@scure/base\";\nvar _fetch4;\ntry {\n  _fetch4 = fetch;\n} catch {\n}\nfunction useFetchImplementation4(fetchImplementation) {\n  _fetch4 = fetchImplementation;\n}\nasync function getZapEndpoint(metadata) {\n  try {\n    let lnurl = \"\";\n    let { lud06, lud16 } = JSON.parse(metadata.content);\n    if (lud06) {\n      let { words } = bech322.decode(lud06, 1e3);\n      let data = bech322.fromWords(words);\n      lnurl = utf8Decoder.decode(data);\n    } else if (lud16) {\n      let [name, domain] = lud16.split(\"@\");\n      lnurl = new URL(`/.well-known/lnurlp/${name}`, `https://${domain}`).toString();\n    } else {\n      return null;\n    }\n    let res = await _fetch4(lnurl);\n    let body = await res.json();\n    if (body.allowsNostr && body.nostrPubkey) {\n      return body.callback;\n    }\n  } catch (err) {\n  }\n  return null;\n}\nfunction makeZapRequest({\n  profile,\n  event,\n  amount,\n  relays,\n  comment = \"\"\n}) {\n  if (!amount)\n    throw new Error(\"amount not given\");\n  if (!profile)\n    throw new Error(\"profile not given\");\n  let zr = {\n    kind: 9734,\n    created_at: Math.round(Date.now() / 1e3),\n    content: comment,\n    tags: [\n      [\"p\", profile],\n      [\"amount\", amount.toString()],\n      [\"relays\", ...relays]\n    ]\n  };\n  if (event) {\n    zr.tags.push([\"e\", event]);\n  }\n  return zr;\n}\nfunction validateZapRequest(zapRequestString) {\n  let zapRequest;\n  try {\n    zapRequest = JSON.parse(zapRequestString);\n  } catch (err) {\n    return \"Invalid zap request JSON.\";\n  }\n  if (!validateEvent(zapRequest))\n    return \"Zap request is not a valid Nostr event.\";\n  if (!verifyEvent(zapRequest))\n    return \"Invalid signature on zap request.\";\n  let p = zapRequest.tags.find(([t, v]) => t === \"p\" && v);\n  if (!p)\n    return \"Zap request doesn't have a 'p' tag.\";\n  if (!p[1].match(/^[a-f0-9]{64}$/))\n    return \"Zap request 'p' tag is not valid hex.\";\n  let e = zapRequest.tags.find(([t, v]) => t === \"e\" && v);\n  if (e && !e[1].match(/^[a-f0-9]{64}$/))\n    return \"Zap request 'e' tag is not valid hex.\";\n  let relays = zapRequest.tags.find(([t, v]) => t === \"relays\" && v);\n  if (!relays)\n    return \"Zap request doesn't have a 'relays' tag.\";\n  return null;\n}\nfunction makeZapReceipt({\n  zapRequest,\n  preimage,\n  bolt11,\n  paidAt\n}) {\n  let zr = JSON.parse(zapRequest);\n  let tagsFromZapRequest = zr.tags.filter(([t]) => t === \"e\" || t === \"p\" || t === \"a\");\n  let zap = {\n    kind: 9735,\n    created_at: Math.round(paidAt.getTime() / 1e3),\n    content: \"\",\n    tags: [...tagsFromZapRequest, [\"P\", zr.pubkey], [\"bolt11\", bolt11], [\"description\", zapRequest]]\n  };\n  if (preimage) {\n    zap.tags.push([\"preimage\", preimage]);\n  }\n  return zap;\n}\n\n// nip98.ts\nvar nip98_exports = {};\n__export(nip98_exports, {\n  getToken: () => getToken,\n  hashPayload: () => hashPayload,\n  unpackEventFromToken: () => unpackEventFromToken,\n  validateEvent: () => validateEvent2,\n  validateEventKind: () => validateEventKind,\n  validateEventMethodTag: () => validateEventMethodTag,\n  validateEventPayloadTag: () => validateEventPayloadTag,\n  validateEventTimestamp: () => validateEventTimestamp,\n  validateEventUrlTag: () => validateEventUrlTag,\n  validateToken: () => validateToken\n});\nimport { sha256 as sha2563 } from \"@noble/hashes/sha256\";\nimport { bytesToHex as bytesToHex4 } from \"@noble/hashes/utils\";\nimport { base64 as base643 } from \"@scure/base\";\nvar _authorizationScheme = \"Nostr \";\nasync function getToken(loginUrl, httpMethod, sign, includeAuthorizationScheme = false, payload) {\n  const event = {\n    kind: HTTPAuth,\n    tags: [\n      [\"u\", loginUrl],\n      [\"method\", httpMethod]\n    ],\n    created_at: Math.round(new Date().getTime() / 1e3),\n    content: \"\"\n  };\n  if (payload) {\n    event.tags.push([\"payload\", hashPayload(payload)]);\n  }\n  const signedEvent = await sign(event);\n  const authorizationScheme = includeAuthorizationScheme ? _authorizationScheme : \"\";\n  return authorizationScheme + base643.encode(utf8Encoder.encode(JSON.stringify(signedEvent)));\n}\nasync function validateToken(token, url, method) {\n  const event = await unpackEventFromToken(token).catch((error) => {\n    throw error;\n  });\n  const valid = await validateEvent2(event, url, method).catch((error) => {\n    throw error;\n  });\n  return valid;\n}\nasync function unpackEventFromToken(token) {\n  if (!token) {\n    throw new Error(\"Missing token\");\n  }\n  token = token.replace(_authorizationScheme, \"\");\n  const eventB64 = utf8Decoder.decode(base643.decode(token));\n  if (!eventB64 || eventB64.length === 0 || !eventB64.startsWith(\"{\")) {\n    throw new Error(\"Invalid token\");\n  }\n  const event = JSON.parse(eventB64);\n  return event;\n}\nfunction validateEventTimestamp(event) {\n  if (!event.created_at) {\n    return false;\n  }\n  return Math.round(new Date().getTime() / 1e3) - event.created_at < 60;\n}\nfunction validateEventKind(event) {\n  return event.kind === HTTPAuth;\n}\nfunction validateEventUrlTag(event, url) {\n  const urlTag = event.tags.find((t) => t[0] === \"u\");\n  if (!urlTag) {\n    return false;\n  }\n  return urlTag.length > 0 && urlTag[1] === url;\n}\nfunction validateEventMethodTag(event, method) {\n  const methodTag = event.tags.find((t) => t[0] === \"method\");\n  if (!methodTag) {\n    return false;\n  }\n  return methodTag.length > 0 && methodTag[1].toLowerCase() === method.toLowerCase();\n}\nfunction hashPayload(payload) {\n  const hash = sha2563(utf8Encoder.encode(JSON.stringify(payload)));\n  return bytesToHex4(hash);\n}\nfunction validateEventPayloadTag(event, payload) {\n  const payloadTag = event.tags.find((t) => t[0] === \"payload\");\n  if (!payloadTag) {\n    return false;\n  }\n  const payloadHash = hashPayload(payload);\n  return payloadTag.length > 0 && payloadTag[1] === payloadHash;\n}\nasync function validateEvent2(event, url, method, body) {\n  if (!verifyEvent(event)) {\n    throw new Error(\"Invalid nostr event, signature invalid\");\n  }\n  if (!validateEventKind(event)) {\n    throw new Error(\"Invalid nostr event, kind invalid\");\n  }\n  if (!validateEventTimestamp(event)) {\n    throw new Error(\"Invalid nostr event, created_at timestamp invalid\");\n  }\n  if (!validateEventUrlTag(event, url)) {\n    throw new Error(\"Invalid nostr event, url tag invalid\");\n  }\n  if (!validateEventMethodTag(event, method)) {\n    throw new Error(\"Invalid nostr event, method tag invalid\");\n  }\n  if (Boolean(body) && typeof body === \"object\" && Object.keys(body).length > 0) {\n    if (!validateEventPayloadTag(event, body)) {\n      throw new Error(\"Invalid nostr event, payload tag does not match request body hash\");\n    }\n  }\n  return true;\n}\nexport {\n  AbstractRelay,\n  AbstractSimplePool,\n  Relay,\n  SimplePool,\n  Subscription,\n  finalizeEvent,\n  fakejson_exports as fj,\n  generateSecretKey,\n  getEventHash,\n  getFilterLimit,\n  getPublicKey,\n  kinds_exports as kinds,\n  matchFilter,\n  matchFilters,\n  mergeFilters,\n  nip04_exports as nip04,\n  nip05_exports as nip05,\n  nip10_exports as nip10,\n  nip11_exports as nip11,\n  nip13_exports as nip13,\n  nip18_exports as nip18,\n  nip19_exports as nip19,\n  nip21_exports as nip21,\n  nip25_exports as nip25,\n  nip27_exports as nip27,\n  nip28_exports as nip28,\n  nip30_exports as nip30,\n  nip39_exports as nip39,\n  nip42_exports as nip42,\n  nip44_exports as nip44,\n  nip47_exports as nip47,\n  nip57_exports as nip57,\n  nip98_exports as nip98,\n  parseReferences,\n  relayConnect,\n  serializeEvent,\n  utils_exports as utils,\n  validateEvent,\n  verifiedSymbol,\n  verifyEvent\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}